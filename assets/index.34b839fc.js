var Ha=Object.defineProperty,Ga=Object.defineProperties;var Ja=Object.getOwnPropertyDescriptors;var In=Object.getOwnPropertySymbols;var Ba=Object.prototype.hasOwnProperty,Wa=Object.prototype.propertyIsEnumerable;var jn=(e,t,r)=>t in e?Ha(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,pe=(e,t)=>{for(var r in t||(t={}))Ba.call(t,r)&&jn(e,r,t[r]);if(In)for(var r of In(t))Wa.call(t,r)&&jn(e,r,t[r]);return e},Ke=(e,t)=>Ga(e,Ja(t));import{slice as Xa,openArray as Qa}from"https://cdn.skypack.dev/zarr";const Ya=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}};Ya();var Za=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function xa(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Pr={exports:{}},xn={},Te={},_t={},Gt={},J={},Kt={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends t{constructor(b){if(super(),!e.IDENTIFIER.test(b))throw new Error("CodeGen: name must be a valid identifier");this.str=b}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=r;class a extends t{constructor(b){super(),this._items=typeof b=="string"?[b]:b}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const b=this._items[0];return b===""||b==='""'}get str(){var b;return(b=this._str)!==null&&b!==void 0?b:this._str=this._items.reduce((O,j)=>`${O}${j}`,"")}get names(){var b;return(b=this._names)!==null&&b!==void 0?b:this._names=this._items.reduce((O,j)=>(j instanceof r&&(O[j.str]=(O[j.str]||0)+1),O),{})}}e._Code=a,e.nil=new a("");function n(f,...b){const O=[f[0]];let j=0;for(;j<b.length;)p(O,b[j]),O.push(f[++j]);return new a(O)}e._=n;const o=new a("+");function c(f,...b){const O=[R(f[0])];let j=0;for(;j<b.length;)O.push(o),p(O,b[j]),O.push(o,R(f[++j]));return y(O),new a(O)}e.str=c;function p(f,b){b instanceof a?f.push(...b._items):b instanceof r?f.push(b):f.push(v(b))}e.addCodeArg=p;function y(f){let b=1;for(;b<f.length-1;){if(f[b]===o){const O=h(f[b-1],f[b+1]);if(O!==void 0){f.splice(b-1,3,O);continue}f[b++]="+"}b++}}function h(f,b){if(b==='""')return f;if(f==='""')return b;if(typeof f=="string")return b instanceof r||f[f.length-1]!=='"'?void 0:typeof b!="string"?`${f.slice(0,-1)}${b}"`:b[0]==='"'?f.slice(0,-1)+b.slice(1):void 0;if(typeof b=="string"&&b[0]==='"'&&!(f instanceof r))return`"${f}${b.slice(1)}`}function m(f,b){return b.emptyStr()?f:f.emptyStr()?b:c`${f}${b}`}e.strConcat=m;function v(f){return typeof f=="number"||typeof f=="boolean"||f===null?f:R(Array.isArray(f)?f.join(","):f)}function I(f){return new a(R(f))}e.stringify=I;function R(f){return JSON.stringify(f).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.safeStringify=R;function N(f){return typeof f=="string"&&e.IDENTIFIER.test(f)?new a(`.${f}`):n`[${f}]`}e.getProperty=N;function _(f){if(typeof f=="string"&&e.IDENTIFIER.test(f))return new a(`${f}`);throw new Error(`CodeGen: invalid export name: ${f}, use explicit $id name mapping`)}e.getEsmExportName=_;function g(f){return new a(f.toString())}e.regexpCode=g})(Kt);var Nr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=Kt;class r extends Error{constructor(h){super(`CodeGen: "code" for ${h} not defined`),this.value=h.value}}var a;(function(y){y[y.Started=0]="Started",y[y.Completed=1]="Completed"})(a=e.UsedValueState||(e.UsedValueState={})),e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class n{constructor({prefixes:h,parent:m}={}){this._names={},this._prefixes=h,this._parent=m}toName(h){return h instanceof t.Name?h:this.name(h)}name(h){return new t.Name(this._newName(h))}_newName(h){const m=this._names[h]||this._nameGroup(h);return`${h}${m.index++}`}_nameGroup(h){var m,v;if(((v=(m=this._parent)===null||m===void 0?void 0:m._prefixes)===null||v===void 0?void 0:v.has(h))||this._prefixes&&!this._prefixes.has(h))throw new Error(`CodeGen: prefix "${h}" is not allowed in this scope`);return this._names[h]={prefix:h,index:0}}}e.Scope=n;class o extends t.Name{constructor(h,m){super(m),this.prefix=h}setValue(h,{property:m,itemIndex:v}){this.value=h,this.scopePath=(0,t._)`.${new t.Name(m)}[${v}]`}}e.ValueScopeName=o;const c=(0,t._)`\n`;class p extends n{constructor(h){super(h),this._values={},this._scope=h.scope,this.opts=Ke(pe({},h),{_n:h.lines?c:t.nil})}get(){return this._scope}name(h){return new o(h,this._newName(h))}value(h,m){var v;if(m.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const I=this.toName(h),{prefix:R}=I,N=(v=m.key)!==null&&v!==void 0?v:m.ref;let _=this._values[R];if(_){const b=_.get(N);if(b)return b}else _=this._values[R]=new Map;_.set(N,I);const g=this._scope[R]||(this._scope[R]=[]),f=g.length;return g[f]=m.ref,I.setValue(m,{property:R,itemIndex:f}),I}getValue(h,m){const v=this._values[h];if(!!v)return v.get(m)}scopeRefs(h,m=this._values){return this._reduceValues(m,v=>{if(v.scopePath===void 0)throw new Error(`CodeGen: name "${v}" has no value`);return(0,t._)`${h}${v.scopePath}`})}scopeCode(h=this._values,m,v){return this._reduceValues(h,I=>{if(I.value===void 0)throw new Error(`CodeGen: name "${I}" has no value`);return I.value.code},m,v)}_reduceValues(h,m,v={},I){let R=t.nil;for(const N in h){const _=h[N];if(!_)continue;const g=v[N]=v[N]||new Map;_.forEach(f=>{if(g.has(f))return;g.set(f,a.Started);let b=m(f);if(b){const O=this.opts.es5?e.varKinds.var:e.varKinds.const;R=(0,t._)`${R}${O} ${f} = ${b};${this.opts._n}`}else if(b=I==null?void 0:I(f))R=(0,t._)`${R}${b}${this.opts._n}`;else throw new r(f);g.set(f,a.Completed)})}return R}}e.ValueScope=p})(Nr);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=Kt,r=Nr;var a=Kt;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return a._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return a.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return a.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return a.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return a.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return a.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return a.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return a.Name}});var n=Nr;Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return n.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return n.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return n.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return n.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class o{optimizeNodes(){return this}optimizeNames(s,u){return this}}class c extends o{constructor(s,u,T){super(),this.varKind=s,this.name=u,this.rhs=T}render({es5:s,_n:u}){const T=s?r.varKinds.var:this.varKind,V=this.rhs===void 0?"":` = ${this.rhs}`;return`${T} ${this.name}${V};`+u}optimizeNames(s,u){if(!!s[this.name.str])return this.rhs&&(this.rhs=de(this.rhs,s,u)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class p extends o{constructor(s,u,T){super(),this.lhs=s,this.rhs=u,this.sideEffects=T}render({_n:s}){return`${this.lhs} = ${this.rhs};`+s}optimizeNames(s,u){if(!(this.lhs instanceof t.Name&&!s[this.lhs.str]&&!this.sideEffects))return this.rhs=de(this.rhs,s,u),this}get names(){const s=this.lhs instanceof t.Name?{}:pe({},this.lhs.names);return Ee(s,this.rhs)}}class y extends p{constructor(s,u,T,V){super(s,T,V),this.op=u}render({_n:s}){return`${this.lhs} ${this.op}= ${this.rhs};`+s}}class h extends o{constructor(s){super(),this.label=s,this.names={}}render({_n:s}){return`${this.label}:`+s}}class m extends o{constructor(s){super(),this.label=s,this.names={}}render({_n:s}){return`break${this.label?` ${this.label}`:""};`+s}}class v extends o{constructor(s){super(),this.error=s}render({_n:s}){return`throw ${this.error};`+s}get names(){return this.error.names}}class I extends o{constructor(s){super(),this.code=s}render({_n:s}){return`${this.code};`+s}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(s,u){return this.code=de(this.code,s,u),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class R extends o{constructor(s=[]){super(),this.nodes=s}render(s){return this.nodes.reduce((u,T)=>u+T.render(s),"")}optimizeNodes(){const{nodes:s}=this;let u=s.length;for(;u--;){const T=s[u].optimizeNodes();Array.isArray(T)?s.splice(u,1,...T):T?s[u]=T:s.splice(u,1)}return s.length>0?this:void 0}optimizeNames(s,u){const{nodes:T}=this;let V=T.length;for(;V--;){const F=T[V];F.optimizeNames(s,u)||(We(s,F.names),T.splice(V,1))}return T.length>0?this:void 0}get names(){return this.nodes.reduce((s,u)=>Y(s,u.names),{})}}class N extends R{render(s){return"{"+s._n+super.render(s)+"}"+s._n}}class _ extends R{}class g extends N{}g.kind="else";class f extends N{constructor(s,u){super(u),this.condition=s}render(s){let u=`if(${this.condition})`+super.render(s);return this.else&&(u+="else "+this.else.render(s)),u}optimizeNodes(){super.optimizeNodes();const s=this.condition;if(s===!0)return this.nodes;let u=this.else;if(u){const T=u.optimizeNodes();u=this.else=Array.isArray(T)?new g(T):T}if(u)return s===!1?u instanceof f?u:u.nodes:this.nodes.length?this:new f(Xe(s),u instanceof f?[u]:u.nodes);if(!(s===!1||!this.nodes.length))return this}optimizeNames(s,u){var T;if(this.else=(T=this.else)===null||T===void 0?void 0:T.optimizeNames(s,u),!!(super.optimizeNames(s,u)||this.else))return this.condition=de(this.condition,s,u),this}get names(){const s=super.names;return Ee(s,this.condition),this.else&&Y(s,this.else.names),s}}f.kind="if";class b extends N{}b.kind="for";class O extends b{constructor(s){super(),this.iteration=s}render(s){return`for(${this.iteration})`+super.render(s)}optimizeNames(s,u){if(!!super.optimizeNames(s,u))return this.iteration=de(this.iteration,s,u),this}get names(){return Y(super.names,this.iteration.names)}}class j extends b{constructor(s,u,T,V){super(),this.varKind=s,this.name=u,this.from=T,this.to=V}render(s){const u=s.es5?r.varKinds.var:this.varKind,{name:T,from:V,to:F}=this;return`for(${u} ${T}=${V}; ${T}<${F}; ${T}++)`+super.render(s)}get names(){const s=Ee(super.names,this.from);return Ee(s,this.to)}}class A extends b{constructor(s,u,T,V){super(),this.loop=s,this.varKind=u,this.name=T,this.iterable=V}render(s){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(s)}optimizeNames(s,u){if(!!super.optimizeNames(s,u))return this.iterable=de(this.iterable,s,u),this}get names(){return Y(super.names,this.iterable.names)}}class w extends N{constructor(s,u,T){super(),this.name=s,this.args=u,this.async=T}render(s){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(s)}}w.kind="func";class C extends R{render(s){return"return "+super.render(s)}}C.kind="return";class D extends N{render(s){let u="try"+super.render(s);return this.catch&&(u+=this.catch.render(s)),this.finally&&(u+=this.finally.render(s)),u}optimizeNodes(){var s,u;return super.optimizeNodes(),(s=this.catch)===null||s===void 0||s.optimizeNodes(),(u=this.finally)===null||u===void 0||u.optimizeNodes(),this}optimizeNames(s,u){var T,V;return super.optimizeNames(s,u),(T=this.catch)===null||T===void 0||T.optimizeNames(s,u),(V=this.finally)===null||V===void 0||V.optimizeNames(s,u),this}get names(){const s=super.names;return this.catch&&Y(s,this.catch.names),this.finally&&Y(s,this.finally.names),s}}class K extends N{constructor(s){super(),this.error=s}render(s){return`catch(${this.error})`+super.render(s)}}K.kind="catch";class B extends N{render(s){return"finally"+super.render(s)}}B.kind="finally";class se{constructor(s,u={}){this._values={},this._blockStarts=[],this._constants={},this.opts=Ke(pe({},u),{_n:u.lines?`
`:""}),this._extScope=s,this._scope=new r.Scope({parent:s}),this._nodes=[new _]}toString(){return this._root.render(this.opts)}name(s){return this._scope.name(s)}scopeName(s){return this._extScope.name(s)}scopeValue(s,u){const T=this._extScope.value(s,u);return(this._values[T.prefix]||(this._values[T.prefix]=new Set)).add(T),T}getScopeValue(s,u){return this._extScope.getValue(s,u)}scopeRefs(s){return this._extScope.scopeRefs(s,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(s,u,T,V){const F=this._scope.toName(u);return T!==void 0&&V&&(this._constants[F.str]=T),this._leafNode(new c(s,F,T)),F}const(s,u,T){return this._def(r.varKinds.const,s,u,T)}let(s,u,T){return this._def(r.varKinds.let,s,u,T)}var(s,u,T){return this._def(r.varKinds.var,s,u,T)}assign(s,u,T){return this._leafNode(new p(s,u,T))}add(s,u){return this._leafNode(new y(s,e.operators.ADD,u))}code(s){return typeof s=="function"?s():s!==t.nil&&this._leafNode(new I(s)),this}object(...s){const u=["{"];for(const[T,V]of s)u.length>1&&u.push(","),u.push(T),(T!==V||this.opts.es5)&&(u.push(":"),(0,t.addCodeArg)(u,V));return u.push("}"),new t._Code(u)}if(s,u,T){if(this._blockNode(new f(s)),u&&T)this.code(u).else().code(T).endIf();else if(u)this.code(u).endIf();else if(T)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(s){return this._elseNode(new f(s))}else(){return this._elseNode(new g)}endIf(){return this._endBlockNode(f,g)}_for(s,u){return this._blockNode(s),u&&this.code(u).endFor(),this}for(s,u){return this._for(new O(s),u)}forRange(s,u,T,V,F=this.opts.es5?r.varKinds.var:r.varKinds.let){const W=this._scope.toName(s);return this._for(new j(F,W,u,T),()=>V(W))}forOf(s,u,T,V=r.varKinds.const){const F=this._scope.toName(s);if(this.opts.es5){const W=u instanceof t.Name?u:this.var("_arr",u);return this.forRange("_i",0,(0,t._)`${W}.length`,Q=>{this.var(F,(0,t._)`${W}[${Q}]`),T(F)})}return this._for(new A("of",V,F,u),()=>T(F))}forIn(s,u,T,V=this.opts.es5?r.varKinds.var:r.varKinds.const){if(this.opts.ownProperties)return this.forOf(s,(0,t._)`Object.keys(${u})`,T);const F=this._scope.toName(s);return this._for(new A("in",V,F,u),()=>T(F))}endFor(){return this._endBlockNode(b)}label(s){return this._leafNode(new h(s))}break(s){return this._leafNode(new m(s))}return(s){const u=new C;if(this._blockNode(u),this.code(s),u.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(C)}try(s,u,T){if(!u&&!T)throw new Error('CodeGen: "try" without "catch" and "finally"');const V=new D;if(this._blockNode(V),this.code(s),u){const F=this.name("e");this._currNode=V.catch=new K(F),u(F)}return T&&(this._currNode=V.finally=new B,this.code(T)),this._endBlockNode(K,B)}throw(s){return this._leafNode(new v(s))}block(s,u){return this._blockStarts.push(this._nodes.length),s&&this.code(s).endBlock(u),this}endBlock(s){const u=this._blockStarts.pop();if(u===void 0)throw new Error("CodeGen: not in self-balancing block");const T=this._nodes.length-u;if(T<0||s!==void 0&&T!==s)throw new Error(`CodeGen: wrong number of nodes: ${T} vs ${s} expected`);return this._nodes.length=u,this}func(s,u=t.nil,T,V){return this._blockNode(new w(s,u,T)),V&&this.code(V).endFunc(),this}endFunc(){return this._endBlockNode(w)}optimize(s=1){for(;s-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(s){return this._currNode.nodes.push(s),this}_blockNode(s){this._currNode.nodes.push(s),this._nodes.push(s)}_endBlockNode(s,u){const T=this._currNode;if(T instanceof s||u&&T instanceof u)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${u?`${s.kind}/${u.kind}`:s.kind}"`)}_elseNode(s){const u=this._currNode;if(!(u instanceof f))throw new Error('CodeGen: "else" without "if"');return this._currNode=u.else=s,this}get _root(){return this._nodes[0]}get _currNode(){const s=this._nodes;return s[s.length-1]}set _currNode(s){const u=this._nodes;u[u.length-1]=s}}e.CodeGen=se;function Y(E,s){for(const u in s)E[u]=(E[u]||0)+(s[u]||0);return E}function Ee(E,s){return s instanceof t._CodeOrName?Y(E,s.names):E}function de(E,s,u){if(E instanceof t.Name)return T(E);if(!V(E))return E;return new t._Code(E._items.reduce((F,W)=>(W instanceof t.Name&&(W=T(W)),W instanceof t._Code?F.push(...W._items):F.push(W),F),[]));function T(F){const W=u[F.str];return W===void 0||s[F.str]!==1?F:(delete s[F.str],W)}function V(F){return F instanceof t._Code&&F._items.some(W=>W instanceof t.Name&&s[W.str]===1&&u[W.str]!==void 0)}}function We(E,s){for(const u in s)E[u]=(E[u]||0)-(s[u]||0)}function Xe(E){return typeof E=="boolean"||typeof E=="number"||E===null?!E:(0,t._)`!${k(E)}`}e.not=Xe;const it=$(e.operators.AND);function St(...E){return E.reduce(it)}e.and=St;const ct=$(e.operators.OR);function M(...E){return E.reduce(ct)}e.or=M;function $(E){return(s,u)=>s===t.nil?u:u===t.nil?s:(0,t._)`${k(s)} ${E} ${k(u)}`}function k(E){return E instanceof t.Name?E:(0,t._)`(${E})`}})(J);var x={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.checkStrictMode=e.getErrorPath=e.Type=e.useFunc=e.setEvaluated=e.evaluatedPropsToName=e.mergeEvaluated=e.eachItem=e.unescapeJsonPointer=e.escapeJsonPointer=e.escapeFragment=e.unescapeFragment=e.schemaRefOrVal=e.schemaHasRulesButRef=e.schemaHasRules=e.checkUnknownRules=e.alwaysValidSchema=e.toHash=void 0;const t=J,r=Kt;function a(w){const C={};for(const D of w)C[D]=!0;return C}e.toHash=a;function n(w,C){return typeof C=="boolean"?C:Object.keys(C).length===0?!0:(o(w,C),!c(C,w.self.RULES.all))}e.alwaysValidSchema=n;function o(w,C=w.schema){const{opts:D,self:K}=w;if(!D.strictSchema||typeof C=="boolean")return;const B=K.RULES.keywords;for(const se in C)B[se]||A(w,`unknown keyword: "${se}"`)}e.checkUnknownRules=o;function c(w,C){if(typeof w=="boolean")return!w;for(const D in w)if(C[D])return!0;return!1}e.schemaHasRules=c;function p(w,C){if(typeof w=="boolean")return!w;for(const D in w)if(D!=="$ref"&&C.all[D])return!0;return!1}e.schemaHasRulesButRef=p;function y({topSchemaRef:w,schemaPath:C},D,K,B){if(!B){if(typeof D=="number"||typeof D=="boolean")return D;if(typeof D=="string")return(0,t._)`${D}`}return(0,t._)`${w}${C}${(0,t.getProperty)(K)}`}e.schemaRefOrVal=y;function h(w){return I(decodeURIComponent(w))}e.unescapeFragment=h;function m(w){return encodeURIComponent(v(w))}e.escapeFragment=m;function v(w){return typeof w=="number"?`${w}`:w.replace(/~/g,"~0").replace(/\//g,"~1")}e.escapeJsonPointer=v;function I(w){return w.replace(/~1/g,"/").replace(/~0/g,"~")}e.unescapeJsonPointer=I;function R(w,C){if(Array.isArray(w))for(const D of w)C(D);else C(w)}e.eachItem=R;function N({mergeNames:w,mergeToName:C,mergeValues:D,resultToName:K}){return(B,se,Y,Ee)=>{const de=Y===void 0?se:Y instanceof t.Name?(se instanceof t.Name?w(B,se,Y):C(B,se,Y),Y):se instanceof t.Name?(C(B,Y,se),se):D(se,Y);return Ee===t.Name&&!(de instanceof t.Name)?K(B,de):de}}e.mergeEvaluated={props:N({mergeNames:(w,C,D)=>w.if((0,t._)`${D} !== true && ${C} !== undefined`,()=>{w.if((0,t._)`${C} === true`,()=>w.assign(D,!0),()=>w.assign(D,(0,t._)`${D} || {}`).code((0,t._)`Object.assign(${D}, ${C})`))}),mergeToName:(w,C,D)=>w.if((0,t._)`${D} !== true`,()=>{C===!0?w.assign(D,!0):(w.assign(D,(0,t._)`${D} || {}`),g(w,D,C))}),mergeValues:(w,C)=>w===!0?!0:pe(pe({},w),C),resultToName:_}),items:N({mergeNames:(w,C,D)=>w.if((0,t._)`${D} !== true && ${C} !== undefined`,()=>w.assign(D,(0,t._)`${C} === true ? true : ${D} > ${C} ? ${D} : ${C}`)),mergeToName:(w,C,D)=>w.if((0,t._)`${D} !== true`,()=>w.assign(D,C===!0?!0:(0,t._)`${D} > ${C} ? ${D} : ${C}`)),mergeValues:(w,C)=>w===!0?!0:Math.max(w,C),resultToName:(w,C)=>w.var("items",C)})};function _(w,C){if(C===!0)return w.var("props",!0);const D=w.var("props",(0,t._)`{}`);return C!==void 0&&g(w,D,C),D}e.evaluatedPropsToName=_;function g(w,C,D){Object.keys(D).forEach(K=>w.assign((0,t._)`${C}${(0,t.getProperty)(K)}`,!0))}e.setEvaluated=g;const f={};function b(w,C){return w.scopeValue("func",{ref:C,code:f[C.code]||(f[C.code]=new r._Code(C.code))})}e.useFunc=b;var O;(function(w){w[w.Num=0]="Num",w[w.Str=1]="Str"})(O=e.Type||(e.Type={}));function j(w,C,D){if(w instanceof t.Name){const K=C===O.Num;return D?K?(0,t._)`"[" + ${w} + "]"`:(0,t._)`"['" + ${w} + "']"`:K?(0,t._)`"/" + ${w}`:(0,t._)`"/" + ${w}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return D?(0,t.getProperty)(w).toString():"/"+v(w)}e.getErrorPath=j;function A(w,C,D=w.opts.strictSchema){if(!!D){if(C=`strict mode: ${C}`,D===!0)throw new Error(C);w.self.logger.warn(C)}}e.checkStrictMode=A})(x);var Fe={};Object.defineProperty(Fe,"__esModule",{value:!0});const ye=J,es={data:new ye.Name("data"),valCxt:new ye.Name("valCxt"),instancePath:new ye.Name("instancePath"),parentData:new ye.Name("parentData"),parentDataProperty:new ye.Name("parentDataProperty"),rootData:new ye.Name("rootData"),dynamicAnchors:new ye.Name("dynamicAnchors"),vErrors:new ye.Name("vErrors"),errors:new ye.Name("errors"),this:new ye.Name("this"),self:new ye.Name("self"),scope:new ye.Name("scope"),json:new ye.Name("json"),jsonPos:new ye.Name("jsonPos"),jsonLen:new ye.Name("jsonLen"),jsonPart:new ye.Name("jsonPart")};Fe.default=es;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=J,r=x,a=Fe;e.keywordError={message:({keyword:g})=>(0,t.str)`must pass "${g}" keyword validation`},e.keyword$DataError={message:({keyword:g,schemaType:f})=>f?(0,t.str)`"${g}" keyword must be ${f} ($data)`:(0,t.str)`"${g}" keyword is invalid ($data)`};function n(g,f=e.keywordError,b,O){const{it:j}=g,{gen:A,compositeRule:w,allErrors:C}=j,D=v(g,f,b);(O!=null?O:w||C)?y(A,D):h(j,(0,t._)`[${D}]`)}e.reportError=n;function o(g,f=e.keywordError,b){const{it:O}=g,{gen:j,compositeRule:A,allErrors:w}=O,C=v(g,f,b);y(j,C),A||w||h(O,a.default.vErrors)}e.reportExtraError=o;function c(g,f){g.assign(a.default.errors,f),g.if((0,t._)`${a.default.vErrors} !== null`,()=>g.if(f,()=>g.assign((0,t._)`${a.default.vErrors}.length`,f),()=>g.assign(a.default.vErrors,null)))}e.resetErrorsCount=c;function p({gen:g,keyword:f,schemaValue:b,data:O,errsCount:j,it:A}){if(j===void 0)throw new Error("ajv implementation error");const w=g.name("err");g.forRange("i",j,a.default.errors,C=>{g.const(w,(0,t._)`${a.default.vErrors}[${C}]`),g.if((0,t._)`${w}.instancePath === undefined`,()=>g.assign((0,t._)`${w}.instancePath`,(0,t.strConcat)(a.default.instancePath,A.errorPath))),g.assign((0,t._)`${w}.schemaPath`,(0,t.str)`${A.errSchemaPath}/${f}`),A.opts.verbose&&(g.assign((0,t._)`${w}.schema`,b),g.assign((0,t._)`${w}.data`,O))})}e.extendErrors=p;function y(g,f){const b=g.const("err",f);g.if((0,t._)`${a.default.vErrors} === null`,()=>g.assign(a.default.vErrors,(0,t._)`[${b}]`),(0,t._)`${a.default.vErrors}.push(${b})`),g.code((0,t._)`${a.default.errors}++`)}function h(g,f){const{gen:b,validateName:O,schemaEnv:j}=g;j.$async?b.throw((0,t._)`new ${g.ValidationError}(${f})`):(b.assign((0,t._)`${O}.errors`,f),b.return(!1))}const m={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function v(g,f,b){const{createErrors:O}=g.it;return O===!1?(0,t._)`{}`:I(g,f,b)}function I(g,f,b={}){const{gen:O,it:j}=g,A=[R(j,b),N(g,b)];return _(g,f,A),O.object(...A)}function R({errorPath:g},{instancePath:f}){const b=f?(0,t.str)`${g}${(0,r.getErrorPath)(f,r.Type.Str)}`:g;return[a.default.instancePath,(0,t.strConcat)(a.default.instancePath,b)]}function N({keyword:g,it:{errSchemaPath:f}},{schemaPath:b,parentSchema:O}){let j=O?f:(0,t.str)`${f}/${g}`;return b&&(j=(0,t.str)`${j}${(0,r.getErrorPath)(b,r.Type.Str)}`),[m.schemaPath,j]}function _(g,{params:f,message:b},O){const{keyword:j,data:A,schemaValue:w,it:C}=g,{opts:D,propertyName:K,topSchemaRef:B,schemaPath:se}=C;O.push([m.keyword,j],[m.params,typeof f=="function"?f(g):f||(0,t._)`{}`]),D.messages&&O.push([m.message,typeof b=="function"?b(g):b]),D.verbose&&O.push([m.schema,w],[m.parentSchema,(0,t._)`${B}${se}`],[a.default.data,A]),K&&O.push([m.propertyName,K])}})(Gt);Object.defineProperty(_t,"__esModule",{value:!0});_t.boolOrEmptySchema=_t.topBoolOrEmptySchema=void 0;const ts=Gt,rs=J,ns=Fe,as={message:"boolean schema is false"};function ss(e){const{gen:t,schema:r,validateName:a}=e;r===!1?ea(e,!1):typeof r=="object"&&r.$async===!0?t.return(ns.default.data):(t.assign((0,rs._)`${a}.errors`,null),t.return(!0))}_t.topBoolOrEmptySchema=ss;function os(e,t){const{gen:r,schema:a}=e;a===!1?(r.var(t,!1),ea(e)):r.var(t,!0)}_t.boolOrEmptySchema=os;function ea(e,t){const{gen:r,data:a}=e,n={gen:r,keyword:"false schema",data:a,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};(0,ts.reportError)(n,as,void 0,t)}var Jt={},at={};Object.defineProperty(at,"__esModule",{value:!0});at.getRules=at.isJSONType=void 0;const is=["string","number","integer","boolean","null","object","array"],cs=new Set(is);function ls(e){return typeof e=="string"&&cs.has(e)}at.isJSONType=ls;function us(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:Ke(pe({},e),{integer:!0,boolean:!0,null:!0}),rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}at.getRules=us;var Ue={};Object.defineProperty(Ue,"__esModule",{value:!0});Ue.shouldUseRule=Ue.shouldUseGroup=Ue.schemaHasRulesForType=void 0;function ds({schema:e,self:t},r){const a=t.RULES.types[r];return a&&a!==!0&&ta(e,a)}Ue.schemaHasRulesForType=ds;function ta(e,t){return t.rules.some(r=>ra(e,r))}Ue.shouldUseGroup=ta;function ra(e,t){var r;return e[t.keyword]!==void 0||((r=t.definition.implements)===null||r===void 0?void 0:r.some(a=>e[a]!==void 0))}Ue.shouldUseRule=ra;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.reportTypeError=e.checkDataTypes=e.checkDataType=e.coerceAndCheckDataType=e.getJSONTypes=e.getSchemaTypes=e.DataType=void 0;const t=at,r=Ue,a=Gt,n=J,o=x;var c;(function(O){O[O.Correct=0]="Correct",O[O.Wrong=1]="Wrong"})(c=e.DataType||(e.DataType={}));function p(O){const j=y(O.type);if(j.includes("null")){if(O.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!j.length&&O.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');O.nullable===!0&&j.push("null")}return j}e.getSchemaTypes=p;function y(O){const j=Array.isArray(O)?O:O?[O]:[];if(j.every(t.isJSONType))return j;throw new Error("type must be JSONType or JSONType[]: "+j.join(","))}e.getJSONTypes=y;function h(O,j){const{gen:A,data:w,opts:C}=O,D=v(j,C.coerceTypes),K=j.length>0&&!(D.length===0&&j.length===1&&(0,r.schemaHasRulesForType)(O,j[0]));if(K){const B=_(j,w,C.strictNumbers,c.Wrong);A.if(B,()=>{D.length?I(O,j,D):f(O)})}return K}e.coerceAndCheckDataType=h;const m=new Set(["string","number","integer","boolean","null"]);function v(O,j){return j?O.filter(A=>m.has(A)||j==="array"&&A==="array"):[]}function I(O,j,A){const{gen:w,data:C,opts:D}=O,K=w.let("dataType",(0,n._)`typeof ${C}`),B=w.let("coerced",(0,n._)`undefined`);D.coerceTypes==="array"&&w.if((0,n._)`${K} == 'object' && Array.isArray(${C}) && ${C}.length == 1`,()=>w.assign(C,(0,n._)`${C}[0]`).assign(K,(0,n._)`typeof ${C}`).if(_(j,C,D.strictNumbers),()=>w.assign(B,C))),w.if((0,n._)`${B} !== undefined`);for(const Y of A)(m.has(Y)||Y==="array"&&D.coerceTypes==="array")&&se(Y);w.else(),f(O),w.endIf(),w.if((0,n._)`${B} !== undefined`,()=>{w.assign(C,B),R(O,B)});function se(Y){switch(Y){case"string":w.elseIf((0,n._)`${K} == "number" || ${K} == "boolean"`).assign(B,(0,n._)`"" + ${C}`).elseIf((0,n._)`${C} === null`).assign(B,(0,n._)`""`);return;case"number":w.elseIf((0,n._)`${K} == "boolean" || ${C} === null
              || (${K} == "string" && ${C} && ${C} == +${C})`).assign(B,(0,n._)`+${C}`);return;case"integer":w.elseIf((0,n._)`${K} === "boolean" || ${C} === null
              || (${K} === "string" && ${C} && ${C} == +${C} && !(${C} % 1))`).assign(B,(0,n._)`+${C}`);return;case"boolean":w.elseIf((0,n._)`${C} === "false" || ${C} === 0 || ${C} === null`).assign(B,!1).elseIf((0,n._)`${C} === "true" || ${C} === 1`).assign(B,!0);return;case"null":w.elseIf((0,n._)`${C} === "" || ${C} === 0 || ${C} === false`),w.assign(B,null);return;case"array":w.elseIf((0,n._)`${K} === "string" || ${K} === "number"
              || ${K} === "boolean" || ${C} === null`).assign(B,(0,n._)`[${C}]`)}}}function R({gen:O,parentData:j,parentDataProperty:A},w){O.if((0,n._)`${j} !== undefined`,()=>O.assign((0,n._)`${j}[${A}]`,w))}function N(O,j,A,w=c.Correct){const C=w===c.Correct?n.operators.EQ:n.operators.NEQ;let D;switch(O){case"null":return(0,n._)`${j} ${C} null`;case"array":D=(0,n._)`Array.isArray(${j})`;break;case"object":D=(0,n._)`${j} && typeof ${j} == "object" && !Array.isArray(${j})`;break;case"integer":D=K((0,n._)`!(${j} % 1) && !isNaN(${j})`);break;case"number":D=K();break;default:return(0,n._)`typeof ${j} ${C} ${O}`}return w===c.Correct?D:(0,n.not)(D);function K(B=n.nil){return(0,n.and)((0,n._)`typeof ${j} == "number"`,B,A?(0,n._)`isFinite(${j})`:n.nil)}}e.checkDataType=N;function _(O,j,A,w){if(O.length===1)return N(O[0],j,A,w);let C;const D=(0,o.toHash)(O);if(D.array&&D.object){const K=(0,n._)`typeof ${j} != "object"`;C=D.null?K:(0,n._)`!${j} || ${K}`,delete D.null,delete D.array,delete D.object}else C=n.nil;D.number&&delete D.integer;for(const K in D)C=(0,n.and)(C,N(K,j,A,w));return C}e.checkDataTypes=_;const g={message:({schema:O})=>`must be ${O}`,params:({schema:O,schemaValue:j})=>typeof O=="string"?(0,n._)`{type: ${O}}`:(0,n._)`{type: ${j}}`};function f(O){const j=b(O);(0,a.reportError)(j,g)}e.reportTypeError=f;function b(O){const{gen:j,data:A,schema:w}=O,C=(0,o.schemaRefOrVal)(O,w,"type");return{gen:j,keyword:"type",data:A,schema:w.type,schemaCode:C,schemaValue:C,parentSchema:w,params:{},it:O}}})(Jt);var fr={};Object.defineProperty(fr,"__esModule",{value:!0});fr.assignDefaults=void 0;const yt=J,fs=x;function hs(e,t){const{properties:r,items:a}=e.schema;if(t==="object"&&r)for(const n in r)kn(e,n,r[n].default);else t==="array"&&Array.isArray(a)&&a.forEach((n,o)=>kn(e,o,n.default))}fr.assignDefaults=hs;function kn(e,t,r){const{gen:a,compositeRule:n,data:o,opts:c}=e;if(r===void 0)return;const p=(0,yt._)`${o}${(0,yt.getProperty)(t)}`;if(n){(0,fs.checkStrictMode)(e,`default is ignored for: ${p}`);return}let y=(0,yt._)`${p} === undefined`;c.useDefaults==="empty"&&(y=(0,yt._)`${y} || ${p} === null || ${p} === ""`),a.if(y,(0,yt._)`${p} = ${(0,yt.stringify)(r)}`)}var Ve={},G={};Object.defineProperty(G,"__esModule",{value:!0});G.validateUnion=G.validateArray=G.usePattern=G.callValidateCode=G.schemaProperties=G.allSchemaProperties=G.noPropertyInData=G.propertyInData=G.isOwnProperty=G.hasPropFunc=G.reportMissingProp=G.checkMissingProp=G.checkReportMissingProp=void 0;const re=J,jr=x,He=Fe,ms=x;function ps(e,t){const{gen:r,data:a,it:n}=e;r.if(Dr(r,a,t,n.opts.ownProperties),()=>{e.setParams({missingProperty:(0,re._)`${t}`},!0),e.error()})}G.checkReportMissingProp=ps;function ys({gen:e,data:t,it:{opts:r}},a,n){return(0,re.or)(...a.map(o=>(0,re.and)(Dr(e,t,o,r.ownProperties),(0,re._)`${n} = ${o}`)))}G.checkMissingProp=ys;function vs(e,t){e.setParams({missingProperty:t},!0),e.error()}G.reportMissingProp=vs;function na(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,re._)`Object.prototype.hasOwnProperty`})}G.hasPropFunc=na;function kr(e,t,r){return(0,re._)`${na(e)}.call(${t}, ${r})`}G.isOwnProperty=kr;function gs(e,t,r,a){const n=(0,re._)`${t}${(0,re.getProperty)(r)} !== undefined`;return a?(0,re._)`${n} && ${kr(e,t,r)}`:n}G.propertyInData=gs;function Dr(e,t,r,a){const n=(0,re._)`${t}${(0,re.getProperty)(r)} === undefined`;return a?(0,re.or)(n,(0,re.not)(kr(e,t,r))):n}G.noPropertyInData=Dr;function aa(e){return e?Object.keys(e).filter(t=>t!=="__proto__"):[]}G.allSchemaProperties=aa;function $s(e,t){return aa(t).filter(r=>!(0,jr.alwaysValidSchema)(e,t[r]))}G.schemaProperties=$s;function _s({schemaCode:e,data:t,it:{gen:r,topSchemaRef:a,schemaPath:n,errorPath:o},it:c},p,y,h){const m=h?(0,re._)`${e}, ${t}, ${a}${n}`:t,v=[[He.default.instancePath,(0,re.strConcat)(He.default.instancePath,o)],[He.default.parentData,c.parentData],[He.default.parentDataProperty,c.parentDataProperty],[He.default.rootData,He.default.rootData]];c.opts.dynamicRef&&v.push([He.default.dynamicAnchors,He.default.dynamicAnchors]);const I=(0,re._)`${m}, ${r.object(...v)}`;return y!==re.nil?(0,re._)`${p}.call(${y}, ${I})`:(0,re._)`${p}(${I})`}G.callValidateCode=_s;const ws=(0,re._)`new RegExp`;function Es({gen:e,it:{opts:t}},r){const a=t.unicodeRegExp?"u":"",{regExp:n}=t.code,o=n(r,a);return e.scopeValue("pattern",{key:o.toString(),ref:o,code:(0,re._)`${n.code==="new RegExp"?ws:(0,ms.useFunc)(e,n)}(${r}, ${a})`})}G.usePattern=Es;function bs(e){const{gen:t,data:r,keyword:a,it:n}=e,o=t.name("valid");if(n.allErrors){const p=t.let("valid",!0);return c(()=>t.assign(p,!1)),p}return t.var(o,!0),c(()=>t.break()),o;function c(p){const y=t.const("len",(0,re._)`${r}.length`);t.forRange("i",0,y,h=>{e.subschema({keyword:a,dataProp:h,dataPropType:jr.Type.Num},o),t.if((0,re.not)(o),p)})}}G.validateArray=bs;function Ss(e){const{gen:t,schema:r,keyword:a,it:n}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(y=>(0,jr.alwaysValidSchema)(n,y))&&!n.opts.unevaluated)return;const c=t.let("valid",!1),p=t.name("_valid");t.block(()=>r.forEach((y,h)=>{const m=e.subschema({keyword:a,schemaProp:h,compositeRule:!0},p);t.assign(c,(0,re._)`${c} || ${p}`),e.mergeValidEvaluated(m,p)||t.if((0,re.not)(c))})),e.result(c,()=>e.reset(),()=>e.error(!0))}G.validateUnion=Ss;Object.defineProperty(Ve,"__esModule",{value:!0});Ve.validateKeywordUsage=Ve.validSchemaType=Ve.funcKeywordCode=Ve.macroKeywordCode=void 0;const ve=J,tt=Fe,Ps=G,Ns=Gt;function Os(e,t){const{gen:r,keyword:a,schema:n,parentSchema:o,it:c}=e,p=t.macro.call(c.self,n,o,c),y=sa(r,a,p);c.opts.validateSchema!==!1&&c.self.validateSchema(p,!0);const h=r.name("valid");e.subschema({schema:p,schemaPath:ve.nil,errSchemaPath:`${c.errSchemaPath}/${a}`,topSchemaRef:y,compositeRule:!0},h),e.pass(h,()=>e.error(!0))}Ve.macroKeywordCode=Os;function Cs(e,t){var r;const{gen:a,keyword:n,schema:o,parentSchema:c,$data:p,it:y}=e;Rs(y,t);const h=!p&&t.compile?t.compile.call(y.self,o,c,y):t.validate,m=sa(a,n,h),v=a.let("valid");e.block$data(v,I),e.ok((r=t.valid)!==null&&r!==void 0?r:v);function I(){if(t.errors===!1)_(),t.modifying&&Dn(e),g(()=>e.error());else{const f=t.async?R():N();t.modifying&&Dn(e),g(()=>Ts(e,f))}}function R(){const f=a.let("ruleErrs",null);return a.try(()=>_((0,ve._)`await `),b=>a.assign(v,!1).if((0,ve._)`${b} instanceof ${y.ValidationError}`,()=>a.assign(f,(0,ve._)`${b}.errors`),()=>a.throw(b))),f}function N(){const f=(0,ve._)`${m}.errors`;return a.assign(f,null),_(ve.nil),f}function _(f=t.async?(0,ve._)`await `:ve.nil){const b=y.opts.passContext?tt.default.this:tt.default.self,O=!("compile"in t&&!p||t.schema===!1);a.assign(v,(0,ve._)`${f}${(0,Ps.callValidateCode)(e,m,b,O)}`,t.modifying)}function g(f){var b;a.if((0,ve.not)((b=t.valid)!==null&&b!==void 0?b:v),f)}}Ve.funcKeywordCode=Cs;function Dn(e){const{gen:t,data:r,it:a}=e;t.if(a.parentData,()=>t.assign(r,(0,ve._)`${a.parentData}[${a.parentDataProperty}]`))}function Ts(e,t){const{gen:r}=e;r.if((0,ve._)`Array.isArray(${t})`,()=>{r.assign(tt.default.vErrors,(0,ve._)`${tt.default.vErrors} === null ? ${t} : ${tt.default.vErrors}.concat(${t})`).assign(tt.default.errors,(0,ve._)`${tt.default.vErrors}.length`),(0,Ns.extendErrors)(e)},()=>e.error())}function Rs({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}function sa(e,t,r){if(r===void 0)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,ve.stringify)(r)})}function Is(e,t,r=!1){return!t.length||t.some(a=>a==="array"?Array.isArray(e):a==="object"?e&&typeof e=="object"&&!Array.isArray(e):typeof e==a||r&&typeof e=="undefined")}Ve.validSchemaType=Is;function js({schema:e,opts:t,self:r,errSchemaPath:a},n,o){if(Array.isArray(n.keyword)?!n.keyword.includes(o):n.keyword!==o)throw new Error("ajv implementation error");const c=n.dependencies;if(c!=null&&c.some(p=>!Object.prototype.hasOwnProperty.call(e,p)))throw new Error(`parent schema must have dependencies of ${o}: ${c.join(",")}`);if(n.validateSchema&&!n.validateSchema(e[o])){const y=`keyword "${o}" value is invalid at path "${a}": `+r.errorsText(n.validateSchema.errors);if(t.validateSchema==="log")r.logger.error(y);else throw new Error(y)}}Ve.validateKeywordUsage=js;var Be={};Object.defineProperty(Be,"__esModule",{value:!0});Be.extendSubschemaMode=Be.extendSubschemaData=Be.getSubschema=void 0;const Me=J,oa=x;function ks(e,{keyword:t,schemaProp:r,schema:a,schemaPath:n,errSchemaPath:o,topSchemaRef:c}){if(t!==void 0&&a!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(t!==void 0){const p=e.schema[t];return r===void 0?{schema:p,schemaPath:(0,Me._)`${e.schemaPath}${(0,Me.getProperty)(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:p[r],schemaPath:(0,Me._)`${e.schemaPath}${(0,Me.getProperty)(t)}${(0,Me.getProperty)(r)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${(0,oa.escapeFragment)(r)}`}}if(a!==void 0){if(n===void 0||o===void 0||c===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:a,schemaPath:n,topSchemaRef:c,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')}Be.getSubschema=ks;function Ds(e,t,{dataProp:r,dataPropType:a,data:n,dataTypes:o,propertyName:c}){if(n!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:p}=t;if(r!==void 0){const{errorPath:h,dataPathArr:m,opts:v}=t,I=p.let("data",(0,Me._)`${t.data}${(0,Me.getProperty)(r)}`,!0);y(I),e.errorPath=(0,Me.str)`${h}${(0,oa.getErrorPath)(r,a,v.jsPropertySyntax)}`,e.parentDataProperty=(0,Me._)`${r}`,e.dataPathArr=[...m,e.parentDataProperty]}if(n!==void 0){const h=n instanceof Me.Name?n:p.let("data",n,!0);y(h),c!==void 0&&(e.propertyName=c)}o&&(e.dataTypes=o);function y(h){e.data=h,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,h]}}Be.extendSubschemaData=Ds;function As(e,{jtdDiscriminator:t,jtdMetadata:r,compositeRule:a,createErrors:n,allErrors:o}){a!==void 0&&(e.compositeRule=a),n!==void 0&&(e.createErrors=n),o!==void 0&&(e.allErrors=o),e.jtdDiscriminator=t,e.jtdMetadata=r}Be.extendSubschemaMode=As;var me={},ia=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var a,n,o;if(Array.isArray(t)){if(a=t.length,a!=r.length)return!1;for(n=a;n--!==0;)if(!e(t[n],r[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(o=Object.keys(t),a=o.length,a!==Object.keys(r).length)return!1;for(n=a;n--!==0;)if(!Object.prototype.hasOwnProperty.call(r,o[n]))return!1;for(n=a;n--!==0;){var c=o[n];if(!e(t[c],r[c]))return!1}return!0}return t!==t&&r!==r},ca={exports:{}},Je=ca.exports=function(e,t,r){typeof t=="function"&&(r=t,t={}),r=t.cb||r;var a=typeof r=="function"?r:r.pre||function(){},n=r.post||function(){};nr(t,a,n,e,"",e)};Je.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Je.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Je.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Je.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function nr(e,t,r,a,n,o,c,p,y,h){if(a&&typeof a=="object"&&!Array.isArray(a)){t(a,n,o,c,p,y,h);for(var m in a){var v=a[m];if(Array.isArray(v)){if(m in Je.arrayKeywords)for(var I=0;I<v.length;I++)nr(e,t,r,v[I],n+"/"+m+"/"+I,o,n,m,a,I)}else if(m in Je.propsKeywords){if(v&&typeof v=="object")for(var R in v)nr(e,t,r,v[R],n+"/"+m+"/"+Ms(R),o,n,m,a,R)}else(m in Je.keywords||e.allKeys&&!(m in Je.skipKeywords))&&nr(e,t,r,v,n+"/"+m,o,n,m,a)}r(a,n,o,c,p,y,h)}}function Ms(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}Object.defineProperty(me,"__esModule",{value:!0});me.getSchemaRefs=me.resolveUrl=me.normalizeId=me._getFullPath=me.getFullPath=me.inlineRef=void 0;const Vs=x,Fs=ia,zs=ca.exports,Us=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function Ls(e,t=!0){return typeof e=="boolean"?!0:t===!0?!Or(e):t?la(e)<=t:!1}me.inlineRef=Ls;const qs=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function Or(e){for(const t in e){if(qs.has(t))return!0;const r=e[t];if(Array.isArray(r)&&r.some(Or)||typeof r=="object"&&Or(r))return!0}return!1}function la(e){let t=0;for(const r in e){if(r==="$ref")return 1/0;if(t++,!Us.has(r)&&(typeof e[r]=="object"&&(0,Vs.eachItem)(e[r],a=>t+=la(a)),t===1/0))return 1/0}return t}function ua(e,t="",r){r!==!1&&(t=$t(t));const a=e.parse(t);return da(e,a)}me.getFullPath=ua;function da(e,t){return e.serialize(t).split("#")[0]+"#"}me._getFullPath=da;const Ks=/#\/?$/;function $t(e){return e?e.replace(Ks,""):""}me.normalizeId=$t;function Hs(e,t,r){return r=$t(r),e.resolve(t,r)}me.resolveUrl=Hs;const Gs=/^[a-z_][-a-z0-9._]*$/i;function Js(e,t){if(typeof e=="boolean")return{};const{schemaId:r,uriResolver:a}=this.opts,n=$t(e[r]||t),o={"":n},c=ua(a,n,!1),p={},y=new Set;return zs(e,{allKeys:!0},(v,I,R,N)=>{if(N===void 0)return;const _=c+I;let g=o[N];typeof v[r]=="string"&&(g=f.call(this,v[r])),b.call(this,v.$anchor),b.call(this,v.$dynamicAnchor),o[I]=g;function f(O){const j=this.opts.uriResolver.resolve;if(O=$t(g?j(g,O):O),y.has(O))throw m(O);y.add(O);let A=this.refs[O];return typeof A=="string"&&(A=this.refs[A]),typeof A=="object"?h(v,A.schema,O):O!==$t(_)&&(O[0]==="#"?(h(v,p[O],O),p[O]=v):this.refs[O]=_),O}function b(O){if(typeof O=="string"){if(!Gs.test(O))throw new Error(`invalid anchor "${O}"`);f.call(this,`#${O}`)}}}),p;function h(v,I,R){if(I!==void 0&&!Fs(v,I))throw m(R)}function m(v){return new Error(`reference "${v}" resolves to more than one schema`)}}me.getSchemaRefs=Js;Object.defineProperty(Te,"__esModule",{value:!0});Te.getData=Te.KeywordCxt=Te.validateFunctionCode=void 0;const fa=_t,An=Jt,Ar=Ue,ir=Jt,Bs=fr,Vt=Ve,$r=Be,z=J,q=Fe,Ws=me,Le=x,Dt=Gt;function Xs(e){if(pa(e)&&(ya(e),ma(e))){Zs(e);return}ha(e,()=>(0,fa.topBoolOrEmptySchema)(e))}Te.validateFunctionCode=Xs;function ha({gen:e,validateName:t,schema:r,schemaEnv:a,opts:n},o){n.code.es5?e.func(t,(0,z._)`${q.default.data}, ${q.default.valCxt}`,a.$async,()=>{e.code((0,z._)`"use strict"; ${Mn(r,n)}`),Ys(e,n),e.code(o)}):e.func(t,(0,z._)`${q.default.data}, ${Qs(n)}`,a.$async,()=>e.code(Mn(r,n)).code(o))}function Qs(e){return(0,z._)`{${q.default.instancePath}="", ${q.default.parentData}, ${q.default.parentDataProperty}, ${q.default.rootData}=${q.default.data}${e.dynamicRef?(0,z._)`, ${q.default.dynamicAnchors}={}`:z.nil}}={}`}function Ys(e,t){e.if(q.default.valCxt,()=>{e.var(q.default.instancePath,(0,z._)`${q.default.valCxt}.${q.default.instancePath}`),e.var(q.default.parentData,(0,z._)`${q.default.valCxt}.${q.default.parentData}`),e.var(q.default.parentDataProperty,(0,z._)`${q.default.valCxt}.${q.default.parentDataProperty}`),e.var(q.default.rootData,(0,z._)`${q.default.valCxt}.${q.default.rootData}`),t.dynamicRef&&e.var(q.default.dynamicAnchors,(0,z._)`${q.default.valCxt}.${q.default.dynamicAnchors}`)},()=>{e.var(q.default.instancePath,(0,z._)`""`),e.var(q.default.parentData,(0,z._)`undefined`),e.var(q.default.parentDataProperty,(0,z._)`undefined`),e.var(q.default.rootData,q.default.data),t.dynamicRef&&e.var(q.default.dynamicAnchors,(0,z._)`{}`)})}function Zs(e){const{schema:t,opts:r,gen:a}=e;ha(e,()=>{r.$comment&&t.$comment&&ga(e),no(e),a.let(q.default.vErrors,null),a.let(q.default.errors,0),r.unevaluated&&xs(e),va(e),oo(e)})}function xs(e){const{gen:t,validateName:r}=e;e.evaluated=t.const("evaluated",(0,z._)`${r}.evaluated`),t.if((0,z._)`${e.evaluated}.dynamicProps`,()=>t.assign((0,z._)`${e.evaluated}.props`,(0,z._)`undefined`)),t.if((0,z._)`${e.evaluated}.dynamicItems`,()=>t.assign((0,z._)`${e.evaluated}.items`,(0,z._)`undefined`))}function Mn(e,t){const r=typeof e=="object"&&e[t.schemaId];return r&&(t.code.source||t.code.process)?(0,z._)`/*# sourceURL=${r} */`:z.nil}function eo(e,t){if(pa(e)&&(ya(e),ma(e))){to(e,t);return}(0,fa.boolOrEmptySchema)(e,t)}function ma({schema:e,self:t}){if(typeof e=="boolean")return!e;for(const r in e)if(t.RULES.all[r])return!0;return!1}function pa(e){return typeof e.schema!="boolean"}function to(e,t){const{schema:r,gen:a,opts:n}=e;n.$comment&&r.$comment&&ga(e),ao(e),so(e);const o=a.const("_errs",q.default.errors);va(e,o),a.var(t,(0,z._)`${o} === ${q.default.errors}`)}function ya(e){(0,Le.checkUnknownRules)(e),ro(e)}function va(e,t){if(e.opts.jtd)return Vn(e,[],!1,t);const r=(0,An.getSchemaTypes)(e.schema),a=(0,An.coerceAndCheckDataType)(e,r);Vn(e,r,!a,t)}function ro(e){const{schema:t,errSchemaPath:r,opts:a,self:n}=e;t.$ref&&a.ignoreKeywordsWithRef&&(0,Le.schemaHasRulesButRef)(t,n.RULES)&&n.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function no(e){const{schema:t,opts:r}=e;t.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,Le.checkStrictMode)(e,"default is ignored in the schema root")}function ao(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,Ws.resolveUrl)(e.opts.uriResolver,e.baseId,t))}function so(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}function ga({gen:e,schemaEnv:t,schema:r,errSchemaPath:a,opts:n}){const o=r.$comment;if(n.$comment===!0)e.code((0,z._)`${q.default.self}.logger.log(${o})`);else if(typeof n.$comment=="function"){const c=(0,z.str)`${a}/$comment`,p=e.scopeValue("root",{ref:t.root});e.code((0,z._)`${q.default.self}.opts.$comment(${o}, ${c}, ${p}.schema)`)}}function oo(e){const{gen:t,schemaEnv:r,validateName:a,ValidationError:n,opts:o}=e;r.$async?t.if((0,z._)`${q.default.errors} === 0`,()=>t.return(q.default.data),()=>t.throw((0,z._)`new ${n}(${q.default.vErrors})`)):(t.assign((0,z._)`${a}.errors`,q.default.vErrors),o.unevaluated&&io(e),t.return((0,z._)`${q.default.errors} === 0`))}function io({gen:e,evaluated:t,props:r,items:a}){r instanceof z.Name&&e.assign((0,z._)`${t}.props`,r),a instanceof z.Name&&e.assign((0,z._)`${t}.items`,a)}function Vn(e,t,r,a){const{gen:n,schema:o,data:c,allErrors:p,opts:y,self:h}=e,{RULES:m}=h;if(o.$ref&&(y.ignoreKeywordsWithRef||!(0,Le.schemaHasRulesButRef)(o,m))){n.block(()=>_a(e,"$ref",m.all.$ref.definition));return}y.jtd||co(e,t),n.block(()=>{for(const I of m.rules)v(I);v(m.post)});function v(I){!(0,Ar.shouldUseGroup)(o,I)||(I.type?(n.if((0,ir.checkDataType)(I.type,c,y.strictNumbers)),Fn(e,I),t.length===1&&t[0]===I.type&&r&&(n.else(),(0,ir.reportTypeError)(e)),n.endIf()):Fn(e,I),p||n.if((0,z._)`${q.default.errors} === ${a||0}`))}}function Fn(e,t){const{gen:r,schema:a,opts:{useDefaults:n}}=e;n&&(0,Bs.assignDefaults)(e,t.type),r.block(()=>{for(const o of t.rules)(0,Ar.shouldUseRule)(a,o)&&_a(e,o.keyword,o.definition,t.type)})}function co(e,t){e.schemaEnv.meta||!e.opts.strictTypes||(lo(e,t),e.opts.allowUnionTypes||uo(e,t),fo(e,e.dataTypes))}function lo(e,t){if(!!t.length){if(!e.dataTypes.length){e.dataTypes=t;return}t.forEach(r=>{zn(e.dataTypes,r)||Mr(e,`type "${r}" not allowed by context "${e.dataTypes.join(",")}"`)}),e.dataTypes=e.dataTypes.filter(r=>zn(t,r))}}function uo(e,t){t.length>1&&!(t.length===2&&t.includes("null"))&&Mr(e,"use allowUnionTypes to allow union type keyword")}function fo(e,t){const r=e.self.RULES.all;for(const a in r){const n=r[a];if(typeof n=="object"&&(0,Ar.shouldUseRule)(e.schema,n)){const{type:o}=n.definition;o.length&&!o.some(c=>ho(t,c))&&Mr(e,`missing type "${o.join(",")}" for keyword "${a}"`)}}}function ho(e,t){return e.includes(t)||t==="number"&&e.includes("integer")}function zn(e,t){return e.includes(t)||t==="integer"&&e.includes("number")}function Mr(e,t){t+=` at "${e.schemaEnv.baseId+e.errSchemaPath}" (strictTypes)`,(0,Le.checkStrictMode)(e,t,e.opts.strictTypes)}class $a{constructor(t,r,a){if((0,Vt.validateKeywordUsage)(t,r,a),this.gen=t.gen,this.allErrors=t.allErrors,this.keyword=a,this.data=t.data,this.schema=t.schema[a],this.$data=r.$data&&t.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,Le.schemaRefOrVal)(t,this.schema,a,this.$data),this.schemaType=r.schemaType,this.parentSchema=t.schema,this.params={},this.it=t,this.def=r,this.$data)this.schemaCode=t.gen.const("vSchema",wa(this.$data,t));else if(this.schemaCode=this.schemaValue,!(0,Vt.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${a} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=t.gen.const("_errs",q.default.errors))}result(t,r,a){this.failResult((0,z.not)(t),r,a)}failResult(t,r,a){this.gen.if(t),a?a():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(t,r){this.failResult((0,z.not)(t),void 0,r)}fail(t){if(t===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(t),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(t){if(!this.$data)return this.fail(t);const{schemaCode:r}=this;this.fail((0,z._)`${r} !== undefined && (${(0,z.or)(this.invalid$data(),t)})`)}error(t,r,a){if(r){this.setParams(r),this._error(t,a),this.setParams({});return}this._error(t,a)}_error(t,r){(t?Dt.reportExtraError:Dt.reportError)(this,this.def.error,r)}$dataError(){(0,Dt.reportError)(this,this.def.$dataError||Dt.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,Dt.resetErrorsCount)(this.gen,this.errsCount)}ok(t){this.allErrors||this.gen.if(t)}setParams(t,r){r?Object.assign(this.params,t):this.params=t}block$data(t,r,a=z.nil){this.gen.block(()=>{this.check$data(t,a),r()})}check$data(t=z.nil,r=z.nil){if(!this.$data)return;const{gen:a,schemaCode:n,schemaType:o,def:c}=this;a.if((0,z.or)((0,z._)`${n} === undefined`,r)),t!==z.nil&&a.assign(t,!0),(o.length||c.validateSchema)&&(a.elseIf(this.invalid$data()),this.$dataError(),t!==z.nil&&a.assign(t,!1)),a.else()}invalid$data(){const{gen:t,schemaCode:r,schemaType:a,def:n,it:o}=this;return(0,z.or)(c(),p());function c(){if(a.length){if(!(r instanceof z.Name))throw new Error("ajv implementation error");const y=Array.isArray(a)?a:[a];return(0,z._)`${(0,ir.checkDataTypes)(y,r,o.opts.strictNumbers,ir.DataType.Wrong)}`}return z.nil}function p(){if(n.validateSchema){const y=t.scopeValue("validate$data",{ref:n.validateSchema});return(0,z._)`!${y}(${r})`}return z.nil}}subschema(t,r){const a=(0,$r.getSubschema)(this.it,t);(0,$r.extendSubschemaData)(a,this.it,t),(0,$r.extendSubschemaMode)(a,t);const n=Ke(pe(pe({},this.it),a),{items:void 0,props:void 0});return eo(n,r),n}mergeEvaluated(t,r){const{it:a,gen:n}=this;!a.opts.unevaluated||(a.props!==!0&&t.props!==void 0&&(a.props=Le.mergeEvaluated.props(n,t.props,a.props,r)),a.items!==!0&&t.items!==void 0&&(a.items=Le.mergeEvaluated.items(n,t.items,a.items,r)))}mergeValidEvaluated(t,r){const{it:a,gen:n}=this;if(a.opts.unevaluated&&(a.props!==!0||a.items!==!0))return n.if(r,()=>this.mergeEvaluated(t,z.Name)),!0}}Te.KeywordCxt=$a;function _a(e,t,r,a){const n=new $a(e,r,t);"code"in r?r.code(n,a):n.$data&&r.validate?(0,Vt.funcKeywordCode)(n,r):"macro"in r?(0,Vt.macroKeywordCode)(n,r):(r.compile||r.validate)&&(0,Vt.funcKeywordCode)(n,r)}const mo=/^\/(?:[^~]|~0|~1)*$/,po=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function wa(e,{dataLevel:t,dataNames:r,dataPathArr:a}){let n,o;if(e==="")return q.default.rootData;if(e[0]==="/"){if(!mo.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);n=e,o=q.default.rootData}else{const h=po.exec(e);if(!h)throw new Error(`Invalid JSON-pointer: ${e}`);const m=+h[1];if(n=h[2],n==="#"){if(m>=t)throw new Error(y("property/index",m));return a[t-m]}if(m>t)throw new Error(y("data",m));if(o=r[t-m],!n)return o}let c=o;const p=n.split("/");for(const h of p)h&&(o=(0,z._)`${o}${(0,z.getProperty)((0,Le.unescapeJsonPointer)(h))}`,c=(0,z._)`${c} && ${o}`);return c;function y(h,m){return`Cannot access ${h} ${m} levels up, current level is ${t}`}}Te.getData=wa;var hr={};Object.defineProperty(hr,"__esModule",{value:!0});class yo extends Error{constructor(t){super("validation failed"),this.errors=t,this.ajv=this.validation=!0}}hr.default=yo;var mr={};Object.defineProperty(mr,"__esModule",{value:!0});const _r=me;class vo extends Error{constructor(t,r,a,n){super(n||`can't resolve reference ${a} from id ${r}`),this.missingRef=(0,_r.resolveUrl)(t,r,a),this.missingSchema=(0,_r.normalizeId)((0,_r.getFullPath)(t,this.missingRef))}}mr.default=vo;var _e={};Object.defineProperty(_e,"__esModule",{value:!0});_e.resolveSchema=_e.getCompilingSchema=_e.resolveRef=_e.compileSchema=_e.SchemaEnv=void 0;const Ne=J,go=hr,et=Fe,Ce=me,Un=x,$o=Te;class pr{constructor(t){var r;this.refs={},this.dynamicAnchors={};let a;typeof t.schema=="object"&&(a=t.schema),this.schema=t.schema,this.schemaId=t.schemaId,this.root=t.root||this,this.baseId=(r=t.baseId)!==null&&r!==void 0?r:(0,Ce.normalizeId)(a==null?void 0:a[t.schemaId||"$id"]),this.schemaPath=t.schemaPath,this.localRefs=t.localRefs,this.meta=t.meta,this.$async=a==null?void 0:a.$async,this.refs={}}}_e.SchemaEnv=pr;function Vr(e){const t=Ea.call(this,e);if(t)return t;const r=(0,Ce.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:a,lines:n}=this.opts.code,{ownProperties:o}=this.opts,c=new Ne.CodeGen(this.scope,{es5:a,lines:n,ownProperties:o});let p;e.$async&&(p=c.scopeValue("Error",{ref:go.default,code:(0,Ne._)`require("ajv/dist/runtime/validation_error").default`}));const y=c.scopeName("validate");e.validateName=y;const h={gen:c,allErrors:this.opts.allErrors,data:et.default.data,parentData:et.default.parentData,parentDataProperty:et.default.parentDataProperty,dataNames:[et.default.data],dataPathArr:[Ne.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:c.scopeValue("schema",this.opts.code.source===!0?{ref:e.schema,code:(0,Ne.stringify)(e.schema)}:{ref:e.schema}),validateName:y,ValidationError:p,schema:e.schema,schemaEnv:e,rootId:r,baseId:e.baseId||r,schemaPath:Ne.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,Ne._)`""`,opts:this.opts,self:this};let m;try{this._compilations.add(e),(0,$o.validateFunctionCode)(h),c.optimize(this.opts.code.optimize);const v=c.toString();m=`${c.scopeRefs(et.default.scope)}return ${v}`,this.opts.code.process&&(m=this.opts.code.process(m,e));const R=new Function(`${et.default.self}`,`${et.default.scope}`,m)(this,this.scope.get());if(this.scope.value(y,{ref:R}),R.errors=null,R.schema=e.schema,R.schemaEnv=e,e.$async&&(R.$async=!0),this.opts.code.source===!0&&(R.source={validateName:y,validateCode:v,scopeValues:c._values}),this.opts.unevaluated){const{props:N,items:_}=h;R.evaluated={props:N instanceof Ne.Name?void 0:N,items:_ instanceof Ne.Name?void 0:_,dynamicProps:N instanceof Ne.Name,dynamicItems:_ instanceof Ne.Name},R.source&&(R.source.evaluated=(0,Ne.stringify)(R.evaluated))}return e.validate=R,e}catch(v){throw delete e.validate,delete e.validateName,m&&this.logger.error("Error compiling schema, function code:",m),v}finally{this._compilations.delete(e)}}_e.compileSchema=Vr;function _o(e,t,r){var a;r=(0,Ce.resolveUrl)(this.opts.uriResolver,t,r);const n=e.refs[r];if(n)return n;let o=bo.call(this,e,r);if(o===void 0){const c=(a=e.localRefs)===null||a===void 0?void 0:a[r],{schemaId:p}=this.opts;c&&(o=new pr({schema:c,schemaId:p,root:e,baseId:t}))}if(o!==void 0)return e.refs[r]=wo.call(this,o)}_e.resolveRef=_o;function wo(e){return(0,Ce.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:Vr.call(this,e)}function Ea(e){for(const t of this._compilations)if(Eo(t,e))return t}_e.getCompilingSchema=Ea;function Eo(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function bo(e,t){let r;for(;typeof(r=this.refs[t])=="string";)t=r;return r||this.schemas[t]||yr.call(this,e,t)}function yr(e,t){const r=this.opts.uriResolver.parse(t),a=(0,Ce._getFullPath)(this.opts.uriResolver,r);let n=(0,Ce.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&a===n)return wr.call(this,r,e);const o=(0,Ce.normalizeId)(a),c=this.refs[o]||this.schemas[o];if(typeof c=="string"){const p=yr.call(this,e,c);return typeof(p==null?void 0:p.schema)!="object"?void 0:wr.call(this,r,p)}if(typeof(c==null?void 0:c.schema)=="object"){if(c.validate||Vr.call(this,c),o===(0,Ce.normalizeId)(t)){const{schema:p}=c,{schemaId:y}=this.opts,h=p[y];return h&&(n=(0,Ce.resolveUrl)(this.opts.uriResolver,n,h)),new pr({schema:p,schemaId:y,root:e,baseId:n})}return wr.call(this,r,c)}}_e.resolveSchema=yr;const So=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function wr(e,{baseId:t,schema:r,root:a}){var n;if(((n=e.fragment)===null||n===void 0?void 0:n[0])!=="/")return;for(const p of e.fragment.slice(1).split("/")){if(typeof r=="boolean")return;const y=r[(0,Un.unescapeFragment)(p)];if(y===void 0)return;r=y;const h=typeof r=="object"&&r[this.opts.schemaId];!So.has(p)&&h&&(t=(0,Ce.resolveUrl)(this.opts.uriResolver,t,h))}let o;if(typeof r!="boolean"&&r.$ref&&!(0,Un.schemaHasRulesButRef)(r,this.RULES)){const p=(0,Ce.resolveUrl)(this.opts.uriResolver,t,r.$ref);o=yr.call(this,a,p)}const{schemaId:c}=this.opts;if(o=o||new pr({schema:r,schemaId:c,root:a,baseId:t}),o.schema!==o.root.schema)return o}const Po="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",No="Meta-schema for $data reference (JSON AnySchema extension proposal)",Oo="object",Co=["$data"],To={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},Ro=!1;var Io={$id:Po,description:No,type:Oo,required:Co,properties:To,additionalProperties:Ro},Fr={},Cr={exports:{}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(e,t){(function(r,a){a(t)})(Za,function(r){function a(){for(var l=arguments.length,i=Array(l),d=0;d<l;d++)i[d]=arguments[d];if(i.length>1){i[0]=i[0].slice(0,-1);for(var P=i.length-1,S=1;S<P;++S)i[S]=i[S].slice(1,-1);return i[P]=i[P].slice(1),i.join("")}else return i[0]}function n(l){return"(?:"+l+")"}function o(l){return l===void 0?"undefined":l===null?"null":Object.prototype.toString.call(l).split(" ").pop().split("]").shift().toLowerCase()}function c(l){return l.toUpperCase()}function p(l){return l!=null?l instanceof Array?l:typeof l.length!="number"||l.split||l.setInterval||l.call?[l]:Array.prototype.slice.call(l):[]}function y(l,i){var d=l;if(i)for(var P in i)d[P]=i[P];return d}function h(l){var i="[A-Za-z]",d="[0-9]",P=a(d,"[A-Fa-f]"),S=n(n("%[EFef]"+P+"%"+P+P+"%"+P+P)+"|"+n("%[89A-Fa-f]"+P+"%"+P+P)+"|"+n("%"+P+P)),U="[\\:\\/\\?\\#\\[\\]\\@]",L="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",Z=a(U,L),te=l?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",ie=l?"[\\uE000-\\uF8FF]":"[]",X=a(i,d,"[\\-\\.\\_\\~]",te);n(i+a(i,d,"[\\+\\-\\.]")+"*"),n(n(S+"|"+a(X,L,"[\\:]"))+"*");var ee=n(n("25[0-5]")+"|"+n("2[0-4]"+d)+"|"+n("1"+d+d)+"|"+n("0?[1-9]"+d)+"|0?0?"+d),ce=n(ee+"\\."+ee+"\\."+ee+"\\."+ee),H=n(P+"{1,4}"),ne=n(n(H+"\\:"+H)+"|"+ce),fe=n(n(H+"\\:")+"{6}"+ne),ae=n("\\:\\:"+n(H+"\\:")+"{5}"+ne),qe=n(n(H)+"?\\:\\:"+n(H+"\\:")+"{4}"+ne),ke=n(n(n(H+"\\:")+"{0,1}"+H)+"?\\:\\:"+n(H+"\\:")+"{3}"+ne),De=n(n(n(H+"\\:")+"{0,2}"+H)+"?\\:\\:"+n(H+"\\:")+"{2}"+ne),pt=n(n(n(H+"\\:")+"{0,3}"+H)+"?\\:\\:"+H+"\\:"+ne),Ze=n(n(n(H+"\\:")+"{0,4}"+H)+"?\\:\\:"+ne),Se=n(n(n(H+"\\:")+"{0,5}"+H)+"?\\:\\:"+H),Ae=n(n(n(H+"\\:")+"{0,6}"+H)+"?\\:\\:"),xe=n([fe,ae,qe,ke,De,pt,Ze,Se,Ae].join("|")),ze=n(n(X+"|"+S)+"+");n("[vV]"+P+"+\\."+a(X,L,"[\\:]")+"+"),n(n(S+"|"+a(X,L))+"*");var jt=n(S+"|"+a(X,L,"[\\:\\@]"));return n(n(S+"|"+a(X,L,"[\\@]"))+"+"),n(n(jt+"|"+a("[\\/\\?]",ie))+"*"),{NOT_SCHEME:new RegExp(a("[^]",i,d,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(a("[^\\%\\:]",X,L),"g"),NOT_HOST:new RegExp(a("[^\\%\\[\\]\\:]",X,L),"g"),NOT_PATH:new RegExp(a("[^\\%\\/\\:\\@]",X,L),"g"),NOT_PATH_NOSCHEME:new RegExp(a("[^\\%\\/\\@]",X,L),"g"),NOT_QUERY:new RegExp(a("[^\\%]",X,L,"[\\:\\@\\/\\?]",ie),"g"),NOT_FRAGMENT:new RegExp(a("[^\\%]",X,L,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(a("[^]",X,L),"g"),UNRESERVED:new RegExp(X,"g"),OTHER_CHARS:new RegExp(a("[^\\%]",X,Z),"g"),PCT_ENCODED:new RegExp(S,"g"),IPV4ADDRESS:new RegExp("^("+ce+")$"),IPV6ADDRESS:new RegExp("^\\[?("+xe+")"+n(n("\\%25|\\%(?!"+P+"{2})")+"("+ze+")")+"?\\]?$")}}var m=h(!1),v=h(!0),I=function(){function l(i,d){var P=[],S=!0,U=!1,L=void 0;try{for(var Z=i[Symbol.iterator](),te;!(S=(te=Z.next()).done)&&(P.push(te.value),!(d&&P.length===d));S=!0);}catch(ie){U=!0,L=ie}finally{try{!S&&Z.return&&Z.return()}finally{if(U)throw L}}return P}return function(i,d){if(Array.isArray(i))return i;if(Symbol.iterator in Object(i))return l(i,d);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),R=function(l){if(Array.isArray(l)){for(var i=0,d=Array(l.length);i<l.length;i++)d[i]=l[i];return d}else return Array.from(l)},N=2147483647,_=36,g=1,f=26,b=38,O=700,j=72,A=128,w="-",C=/^xn--/,D=/[^\0-\x7E]/,K=/[\x2E\u3002\uFF0E\uFF61]/g,B={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},se=_-g,Y=Math.floor,Ee=String.fromCharCode;function de(l){throw new RangeError(B[l])}function We(l,i){for(var d=[],P=l.length;P--;)d[P]=i(l[P]);return d}function Xe(l,i){var d=l.split("@"),P="";d.length>1&&(P=d[0]+"@",l=d[1]),l=l.replace(K,".");var S=l.split("."),U=We(S,i).join(".");return P+U}function it(l){for(var i=[],d=0,P=l.length;d<P;){var S=l.charCodeAt(d++);if(S>=55296&&S<=56319&&d<P){var U=l.charCodeAt(d++);(U&64512)==56320?i.push(((S&1023)<<10)+(U&1023)+65536):(i.push(S),d--)}else i.push(S)}return i}var St=function(i){return String.fromCodePoint.apply(String,R(i))},ct=function(i){return i-48<10?i-22:i-65<26?i-65:i-97<26?i-97:_},M=function(i,d){return i+22+75*(i<26)-((d!=0)<<5)},$=function(i,d,P){var S=0;for(i=P?Y(i/O):i>>1,i+=Y(i/d);i>se*f>>1;S+=_)i=Y(i/se);return Y(S+(se+1)*i/(i+b))},k=function(i){var d=[],P=i.length,S=0,U=A,L=j,Z=i.lastIndexOf(w);Z<0&&(Z=0);for(var te=0;te<Z;++te)i.charCodeAt(te)>=128&&de("not-basic"),d.push(i.charCodeAt(te));for(var ie=Z>0?Z+1:0;ie<P;){for(var X=S,ee=1,ce=_;;ce+=_){ie>=P&&de("invalid-input");var H=ct(i.charCodeAt(ie++));(H>=_||H>Y((N-S)/ee))&&de("overflow"),S+=H*ee;var ne=ce<=L?g:ce>=L+f?f:ce-L;if(H<ne)break;var fe=_-ne;ee>Y(N/fe)&&de("overflow"),ee*=fe}var ae=d.length+1;L=$(S-X,ae,X==0),Y(S/ae)>N-U&&de("overflow"),U+=Y(S/ae),S%=ae,d.splice(S++,0,U)}return String.fromCodePoint.apply(String,d)},E=function(i){var d=[];i=it(i);var P=i.length,S=A,U=0,L=j,Z=!0,te=!1,ie=void 0;try{for(var X=i[Symbol.iterator](),ee;!(Z=(ee=X.next()).done);Z=!0){var ce=ee.value;ce<128&&d.push(Ee(ce))}}catch(kt){te=!0,ie=kt}finally{try{!Z&&X.return&&X.return()}finally{if(te)throw ie}}var H=d.length,ne=H;for(H&&d.push(w);ne<P;){var fe=N,ae=!0,qe=!1,ke=void 0;try{for(var De=i[Symbol.iterator](),pt;!(ae=(pt=De.next()).done);ae=!0){var Ze=pt.value;Ze>=S&&Ze<fe&&(fe=Ze)}}catch(kt){qe=!0,ke=kt}finally{try{!ae&&De.return&&De.return()}finally{if(qe)throw ke}}var Se=ne+1;fe-S>Y((N-U)/Se)&&de("overflow"),U+=(fe-S)*Se,S=fe;var Ae=!0,xe=!1,ze=void 0;try{for(var jt=i[Symbol.iterator](),On;!(Ae=(On=jt.next()).done);Ae=!0){var Cn=On.value;if(Cn<S&&++U>N&&de("overflow"),Cn==S){for(var Xt=U,Qt=_;;Qt+=_){var Yt=Qt<=L?g:Qt>=L+f?f:Qt-L;if(Xt<Yt)break;var Tn=Xt-Yt,Rn=_-Yt;d.push(Ee(M(Yt+Tn%Rn,0))),Xt=Y(Tn/Rn)}d.push(Ee(M(Xt,0))),L=$(U,Se,ne==H),U=0,++ne}}}catch(kt){xe=!0,ze=kt}finally{try{!Ae&&jt.return&&jt.return()}finally{if(xe)throw ze}}++U,++S}return d.join("")},s=function(i){return Xe(i,function(d){return C.test(d)?k(d.slice(4).toLowerCase()):d})},u=function(i){return Xe(i,function(d){return D.test(d)?"xn--"+E(d):d})},T={version:"2.1.0",ucs2:{decode:it,encode:St},decode:k,encode:E,toASCII:u,toUnicode:s},V={};function F(l){var i=l.charCodeAt(0),d=void 0;return i<16?d="%0"+i.toString(16).toUpperCase():i<128?d="%"+i.toString(16).toUpperCase():i<2048?d="%"+(i>>6|192).toString(16).toUpperCase()+"%"+(i&63|128).toString(16).toUpperCase():d="%"+(i>>12|224).toString(16).toUpperCase()+"%"+(i>>6&63|128).toString(16).toUpperCase()+"%"+(i&63|128).toString(16).toUpperCase(),d}function W(l){for(var i="",d=0,P=l.length;d<P;){var S=parseInt(l.substr(d+1,2),16);if(S<128)i+=String.fromCharCode(S),d+=3;else if(S>=194&&S<224){if(P-d>=6){var U=parseInt(l.substr(d+4,2),16);i+=String.fromCharCode((S&31)<<6|U&63)}else i+=l.substr(d,6);d+=6}else if(S>=224){if(P-d>=9){var L=parseInt(l.substr(d+4,2),16),Z=parseInt(l.substr(d+7,2),16);i+=String.fromCharCode((S&15)<<12|(L&63)<<6|Z&63)}else i+=l.substr(d,9);d+=9}else i+=l.substr(d,3),d+=3}return i}function Q(l,i){function d(P){var S=W(P);return S.match(i.UNRESERVED)?S:P}return l.scheme&&(l.scheme=String(l.scheme).replace(i.PCT_ENCODED,d).toLowerCase().replace(i.NOT_SCHEME,"")),l.userinfo!==void 0&&(l.userinfo=String(l.userinfo).replace(i.PCT_ENCODED,d).replace(i.NOT_USERINFO,F).replace(i.PCT_ENCODED,c)),l.host!==void 0&&(l.host=String(l.host).replace(i.PCT_ENCODED,d).toLowerCase().replace(i.NOT_HOST,F).replace(i.PCT_ENCODED,c)),l.path!==void 0&&(l.path=String(l.path).replace(i.PCT_ENCODED,d).replace(l.scheme?i.NOT_PATH:i.NOT_PATH_NOSCHEME,F).replace(i.PCT_ENCODED,c)),l.query!==void 0&&(l.query=String(l.query).replace(i.PCT_ENCODED,d).replace(i.NOT_QUERY,F).replace(i.PCT_ENCODED,c)),l.fragment!==void 0&&(l.fragment=String(l.fragment).replace(i.PCT_ENCODED,d).replace(i.NOT_FRAGMENT,F).replace(i.PCT_ENCODED,c)),l}function oe(l){return l.replace(/^0*(.*)/,"$1")||"0"}function Re(l,i){var d=l.match(i.IPV4ADDRESS)||[],P=I(d,2),S=P[1];return S?S.split(".").map(oe).join("."):l}function lt(l,i){var d=l.match(i.IPV6ADDRESS)||[],P=I(d,3),S=P[1],U=P[2];if(S){for(var L=S.toLowerCase().split("::").reverse(),Z=I(L,2),te=Z[0],ie=Z[1],X=ie?ie.split(":").map(oe):[],ee=te.split(":").map(oe),ce=i.IPV4ADDRESS.test(ee[ee.length-1]),H=ce?7:8,ne=ee.length-H,fe=Array(H),ae=0;ae<H;++ae)fe[ae]=X[ae]||ee[ne+ae]||"";ce&&(fe[H-1]=Re(fe[H-1],i));var qe=fe.reduce(function(Se,Ae,xe){if(!Ae||Ae==="0"){var ze=Se[Se.length-1];ze&&ze.index+ze.length===xe?ze.length++:Se.push({index:xe,length:1})}return Se},[]),ke=qe.sort(function(Se,Ae){return Ae.length-Se.length})[0],De=void 0;if(ke&&ke.length>1){var pt=fe.slice(0,ke.index),Ze=fe.slice(ke.index+ke.length);De=pt.join(":")+"::"+Ze.join(":")}else De=fe.join(":");return U&&(De+="%"+U),De}else return l}var Pt=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Nt="".match(/(){0}/)[1]===void 0;function we(l){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d={},P=i.iri!==!1?v:m;i.reference==="suffix"&&(l=(i.scheme?i.scheme+":":"")+"//"+l);var S=l.match(Pt);if(S){Nt?(d.scheme=S[1],d.userinfo=S[3],d.host=S[4],d.port=parseInt(S[5],10),d.path=S[6]||"",d.query=S[7],d.fragment=S[8],isNaN(d.port)&&(d.port=S[5])):(d.scheme=S[1]||void 0,d.userinfo=l.indexOf("@")!==-1?S[3]:void 0,d.host=l.indexOf("//")!==-1?S[4]:void 0,d.port=parseInt(S[5],10),d.path=S[6]||"",d.query=l.indexOf("?")!==-1?S[7]:void 0,d.fragment=l.indexOf("#")!==-1?S[8]:void 0,isNaN(d.port)&&(d.port=l.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?S[4]:void 0)),d.host&&(d.host=lt(Re(d.host,P),P)),d.scheme===void 0&&d.userinfo===void 0&&d.host===void 0&&d.port===void 0&&!d.path&&d.query===void 0?d.reference="same-document":d.scheme===void 0?d.reference="relative":d.fragment===void 0?d.reference="absolute":d.reference="uri",i.reference&&i.reference!=="suffix"&&i.reference!==d.reference&&(d.error=d.error||"URI is not a "+i.reference+" reference.");var U=V[(i.scheme||d.scheme||"").toLowerCase()];if(!i.unicodeSupport&&(!U||!U.unicodeSupport)){if(d.host&&(i.domainHost||U&&U.domainHost))try{d.host=T.toASCII(d.host.replace(P.PCT_ENCODED,W).toLowerCase())}catch(L){d.error=d.error||"Host's domain name can not be converted to ASCII via punycode: "+L}Q(d,m)}else Q(d,P);U&&U.parse&&U.parse(d,i)}else d.error=d.error||"URI can not be parsed.";return d}function Ot(l,i){var d=i.iri!==!1?v:m,P=[];return l.userinfo!==void 0&&(P.push(l.userinfo),P.push("@")),l.host!==void 0&&P.push(lt(Re(String(l.host),d),d).replace(d.IPV6ADDRESS,function(S,U,L){return"["+U+(L?"%25"+L:"")+"]"})),(typeof l.port=="number"||typeof l.port=="string")&&(P.push(":"),P.push(String(l.port))),P.length?P.join(""):void 0}var ut=/^\.\.?\//,dt=/^\/\.(\/|$)/,ft=/^\/\.\.(\/|$)/,Ct=/^\/?(?:.|\n)*?(?=\/|$)/;function Ie(l){for(var i=[];l.length;)if(l.match(ut))l=l.replace(ut,"");else if(l.match(dt))l=l.replace(dt,"/");else if(l.match(ft))l=l.replace(ft,"/"),i.pop();else if(l==="."||l==="..")l="";else{var d=l.match(Ct);if(d){var P=d[0];l=l.slice(P.length),i.push(P)}else throw new Error("Unexpected dot segment condition")}return i.join("")}function ge(l){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=i.iri?v:m,P=[],S=V[(i.scheme||l.scheme||"").toLowerCase()];if(S&&S.serialize&&S.serialize(l,i),l.host&&!d.IPV6ADDRESS.test(l.host)){if(i.domainHost||S&&S.domainHost)try{l.host=i.iri?T.toUnicode(l.host):T.toASCII(l.host.replace(d.PCT_ENCODED,W).toLowerCase())}catch(Z){l.error=l.error||"Host's domain name can not be converted to "+(i.iri?"Unicode":"ASCII")+" via punycode: "+Z}}Q(l,d),i.reference!=="suffix"&&l.scheme&&(P.push(l.scheme),P.push(":"));var U=Ot(l,i);if(U!==void 0&&(i.reference!=="suffix"&&P.push("//"),P.push(U),l.path&&l.path.charAt(0)!=="/"&&P.push("/")),l.path!==void 0){var L=l.path;!i.absolutePath&&(!S||!S.absolutePath)&&(L=Ie(L)),U===void 0&&(L=L.replace(/^\/\//,"/%2F")),P.push(L)}return l.query!==void 0&&(P.push("?"),P.push(l.query)),l.fragment!==void 0&&(P.push("#"),P.push(l.fragment)),P.join("")}function ht(l,i){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},P=arguments[3],S={};return P||(l=we(ge(l,d),d),i=we(ge(i,d),d)),d=d||{},!d.tolerant&&i.scheme?(S.scheme=i.scheme,S.userinfo=i.userinfo,S.host=i.host,S.port=i.port,S.path=Ie(i.path||""),S.query=i.query):(i.userinfo!==void 0||i.host!==void 0||i.port!==void 0?(S.userinfo=i.userinfo,S.host=i.host,S.port=i.port,S.path=Ie(i.path||""),S.query=i.query):(i.path?(i.path.charAt(0)==="/"?S.path=Ie(i.path):((l.userinfo!==void 0||l.host!==void 0||l.port!==void 0)&&!l.path?S.path="/"+i.path:l.path?S.path=l.path.slice(0,l.path.lastIndexOf("/")+1)+i.path:S.path=i.path,S.path=Ie(S.path)),S.query=i.query):(S.path=l.path,i.query!==void 0?S.query=i.query:S.query=l.query),S.userinfo=l.userinfo,S.host=l.host,S.port=l.port),S.scheme=l.scheme),S.fragment=i.fragment,S}function Tt(l,i,d){var P=y({scheme:"null"},d);return ge(ht(we(l,P),we(i,P),P,!0),P)}function Qe(l,i){return typeof l=="string"?l=ge(we(l,i),i):o(l)==="object"&&(l=we(ge(l,i),i)),l}function Rt(l,i,d){return typeof l=="string"?l=ge(we(l,d),d):o(l)==="object"&&(l=ge(l,d)),typeof i=="string"?i=ge(we(i,d),d):o(i)==="object"&&(i=ge(i,d)),l===i}function Wt(l,i){return l&&l.toString().replace(!i||!i.iri?m.ESCAPE:v.ESCAPE,F)}function be(l,i){return l&&l.toString().replace(!i||!i.iri?m.PCT_ENCODED:v.PCT_ENCODED,W)}var Ye={scheme:"http",domainHost:!0,parse:function(i,d){return i.host||(i.error=i.error||"HTTP URIs must have a host."),i},serialize:function(i,d){var P=String(i.scheme).toLowerCase()==="https";return(i.port===(P?443:80)||i.port==="")&&(i.port=void 0),i.path||(i.path="/"),i}},$n={scheme:"https",domainHost:Ye.domainHost,parse:Ye.parse,serialize:Ye.serialize};function _n(l){return typeof l.secure=="boolean"?l.secure:String(l.scheme).toLowerCase()==="wss"}var It={scheme:"ws",domainHost:!0,parse:function(i,d){var P=i;return P.secure=_n(P),P.resourceName=(P.path||"/")+(P.query?"?"+P.query:""),P.path=void 0,P.query=void 0,P},serialize:function(i,d){if((i.port===(_n(i)?443:80)||i.port==="")&&(i.port=void 0),typeof i.secure=="boolean"&&(i.scheme=i.secure?"wss":"ws",i.secure=void 0),i.resourceName){var P=i.resourceName.split("?"),S=I(P,2),U=S[0],L=S[1];i.path=U&&U!=="/"?U:void 0,i.query=L,i.resourceName=void 0}return i.fragment=void 0,i}},wn={scheme:"wss",domainHost:It.domainHost,parse:It.parse,serialize:It.serialize},ka={},En="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",je="[0-9A-Fa-f]",Da=n(n("%[EFef]"+je+"%"+je+je+"%"+je+je)+"|"+n("%[89A-Fa-f]"+je+"%"+je+je)+"|"+n("%"+je+je)),Aa="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Ma="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Va=a(Ma,'[\\"\\\\]'),Fa="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",za=new RegExp(En,"g"),mt=new RegExp(Da,"g"),Ua=new RegExp(a("[^]",Aa,"[\\.]",'[\\"]',Va),"g"),bn=new RegExp(a("[^]",En,Fa),"g"),La=bn;function gr(l){var i=W(l);return i.match(za)?i:l}var Sn={scheme:"mailto",parse:function(i,d){var P=i,S=P.to=P.path?P.path.split(","):[];if(P.path=void 0,P.query){for(var U=!1,L={},Z=P.query.split("&"),te=0,ie=Z.length;te<ie;++te){var X=Z[te].split("=");switch(X[0]){case"to":for(var ee=X[1].split(","),ce=0,H=ee.length;ce<H;++ce)S.push(ee[ce]);break;case"subject":P.subject=be(X[1],d);break;case"body":P.body=be(X[1],d);break;default:U=!0,L[be(X[0],d)]=be(X[1],d);break}}U&&(P.headers=L)}P.query=void 0;for(var ne=0,fe=S.length;ne<fe;++ne){var ae=S[ne].split("@");if(ae[0]=be(ae[0]),d.unicodeSupport)ae[1]=be(ae[1],d).toLowerCase();else try{ae[1]=T.toASCII(be(ae[1],d).toLowerCase())}catch(qe){P.error=P.error||"Email address's domain name can not be converted to ASCII via punycode: "+qe}S[ne]=ae.join("@")}return P},serialize:function(i,d){var P=i,S=p(i.to);if(S){for(var U=0,L=S.length;U<L;++U){var Z=String(S[U]),te=Z.lastIndexOf("@"),ie=Z.slice(0,te).replace(mt,gr).replace(mt,c).replace(Ua,F),X=Z.slice(te+1);try{X=d.iri?T.toUnicode(X):T.toASCII(be(X,d).toLowerCase())}catch(ne){P.error=P.error||"Email address's domain name can not be converted to "+(d.iri?"Unicode":"ASCII")+" via punycode: "+ne}S[U]=ie+"@"+X}P.path=S.join(",")}var ee=i.headers=i.headers||{};i.subject&&(ee.subject=i.subject),i.body&&(ee.body=i.body);var ce=[];for(var H in ee)ee[H]!==ka[H]&&ce.push(H.replace(mt,gr).replace(mt,c).replace(bn,F)+"="+ee[H].replace(mt,gr).replace(mt,c).replace(La,F));return ce.length&&(P.query=ce.join("&")),P}},qa=/^([^\:]+)\:(.*)/,Pn={scheme:"urn",parse:function(i,d){var P=i.path&&i.path.match(qa),S=i;if(P){var U=d.scheme||S.scheme||"urn",L=P[1].toLowerCase(),Z=P[2],te=U+":"+(d.nid||L),ie=V[te];S.nid=L,S.nss=Z,S.path=void 0,ie&&(S=ie.parse(S,d))}else S.error=S.error||"URN can not be parsed.";return S},serialize:function(i,d){var P=d.scheme||i.scheme||"urn",S=i.nid,U=P+":"+(d.nid||S),L=V[U];L&&(i=L.serialize(i,d));var Z=i,te=i.nss;return Z.path=(S||d.nid)+":"+te,Z}},Ka=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Nn={scheme:"urn:uuid",parse:function(i,d){var P=i;return P.uuid=P.nss,P.nss=void 0,!d.tolerant&&(!P.uuid||!P.uuid.match(Ka))&&(P.error=P.error||"UUID is not valid."),P},serialize:function(i,d){var P=i;return P.nss=(i.uuid||"").toLowerCase(),P}};V[Ye.scheme]=Ye,V[$n.scheme]=$n,V[It.scheme]=It,V[wn.scheme]=wn,V[Sn.scheme]=Sn,V[Pn.scheme]=Pn,V[Nn.scheme]=Nn,r.SCHEMES=V,r.pctEncChar=F,r.pctDecChars=W,r.parse=we,r.removeDotSegments=Ie,r.serialize=ge,r.resolveComponents=ht,r.resolve=Tt,r.normalize=Qe,r.equal=Rt,r.escapeComponent=Wt,r.unescapeComponent=be,Object.defineProperty(r,"__esModule",{value:!0})})})(Cr,Cr.exports);Object.defineProperty(Fr,"__esModule",{value:!0});const ba=Cr.exports;ba.code='require("ajv/dist/runtime/uri").default';Fr.default=ba;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=Te;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var r=J;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const a=hr,n=mr,o=at,c=_e,p=J,y=me,h=Jt,m=x,v=Io,I=Fr,R=(M,$)=>new RegExp(M,$);R.code="new RegExp";const N=["removeAdditional","useDefaults","coerceTypes"],_=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),g={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},f={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},b=200;function O(M){var $,k,E,s,u,T,V,F,W,Q,oe,Re,lt,Pt,Nt,we,Ot,ut,dt,ft,Ct,Ie,ge,ht,Tt;const Qe=M.strict,Rt=($=M.code)===null||$===void 0?void 0:$.optimize,Wt=Rt===!0||Rt===void 0?1:Rt||0,be=(E=(k=M.code)===null||k===void 0?void 0:k.regExp)!==null&&E!==void 0?E:R,Ye=(s=M.uriResolver)!==null&&s!==void 0?s:I.default;return{strictSchema:(T=(u=M.strictSchema)!==null&&u!==void 0?u:Qe)!==null&&T!==void 0?T:!0,strictNumbers:(F=(V=M.strictNumbers)!==null&&V!==void 0?V:Qe)!==null&&F!==void 0?F:!0,strictTypes:(Q=(W=M.strictTypes)!==null&&W!==void 0?W:Qe)!==null&&Q!==void 0?Q:"log",strictTuples:(Re=(oe=M.strictTuples)!==null&&oe!==void 0?oe:Qe)!==null&&Re!==void 0?Re:"log",strictRequired:(Pt=(lt=M.strictRequired)!==null&&lt!==void 0?lt:Qe)!==null&&Pt!==void 0?Pt:!1,code:M.code?Ke(pe({},M.code),{optimize:Wt,regExp:be}):{optimize:Wt,regExp:be},loopRequired:(Nt=M.loopRequired)!==null&&Nt!==void 0?Nt:b,loopEnum:(we=M.loopEnum)!==null&&we!==void 0?we:b,meta:(Ot=M.meta)!==null&&Ot!==void 0?Ot:!0,messages:(ut=M.messages)!==null&&ut!==void 0?ut:!0,inlineRefs:(dt=M.inlineRefs)!==null&&dt!==void 0?dt:!0,schemaId:(ft=M.schemaId)!==null&&ft!==void 0?ft:"$id",addUsedSchema:(Ct=M.addUsedSchema)!==null&&Ct!==void 0?Ct:!0,validateSchema:(Ie=M.validateSchema)!==null&&Ie!==void 0?Ie:!0,validateFormats:(ge=M.validateFormats)!==null&&ge!==void 0?ge:!0,unicodeRegExp:(ht=M.unicodeRegExp)!==null&&ht!==void 0?ht:!0,int32range:(Tt=M.int32range)!==null&&Tt!==void 0?Tt:!0,uriResolver:Ye}}class j{constructor($={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,$=this.opts=pe(pe({},$),O($));const{es5:k,lines:E}=this.opts.code;this.scope=new p.ValueScope({scope:{},prefixes:_,es5:k,lines:E}),this.logger=Y($.logger);const s=$.validateFormats;$.validateFormats=!1,this.RULES=(0,o.getRules)(),A.call(this,g,$,"NOT SUPPORTED"),A.call(this,f,$,"DEPRECATED","warn"),this._metaOpts=B.call(this),$.formats&&D.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),$.keywords&&K.call(this,$.keywords),typeof $.meta=="object"&&this.addMetaSchema($.meta),C.call(this),$.validateFormats=s}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:$,meta:k,schemaId:E}=this.opts;let s=v;E==="id"&&(s=pe({},v),s.id=s.$id,delete s.$id),k&&$&&this.addMetaSchema(s,s[E],!1)}defaultMeta(){const{meta:$,schemaId:k}=this.opts;return this.opts.defaultMeta=typeof $=="object"?$[k]||$:void 0}validate($,k){let E;if(typeof $=="string"){if(E=this.getSchema($),!E)throw new Error(`no schema with key or ref "${$}"`)}else E=this.compile($);const s=E(k);return"$async"in E||(this.errors=E.errors),s}compile($,k){const E=this._addSchema($,k);return E.validate||this._compileSchemaEnv(E)}compileAsync($,k){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:E}=this.opts;return s.call(this,$,k);async function s(Q,oe){await u.call(this,Q.$schema);const Re=this._addSchema(Q,oe);return Re.validate||T.call(this,Re)}async function u(Q){Q&&!this.getSchema(Q)&&await s.call(this,{$ref:Q},!0)}async function T(Q){try{return this._compileSchemaEnv(Q)}catch(oe){if(!(oe instanceof n.default))throw oe;return V.call(this,oe),await F.call(this,oe.missingSchema),T.call(this,Q)}}function V({missingSchema:Q,missingRef:oe}){if(this.refs[Q])throw new Error(`AnySchema ${Q} is loaded but ${oe} cannot be resolved`)}async function F(Q){const oe=await W.call(this,Q);this.refs[Q]||await u.call(this,oe.$schema),this.refs[Q]||this.addSchema(oe,Q,k)}async function W(Q){const oe=this._loading[Q];if(oe)return oe;try{return await(this._loading[Q]=E(Q))}finally{delete this._loading[Q]}}}addSchema($,k,E,s=this.opts.validateSchema){if(Array.isArray($)){for(const T of $)this.addSchema(T,void 0,E,s);return this}let u;if(typeof $=="object"){const{schemaId:T}=this.opts;if(u=$[T],u!==void 0&&typeof u!="string")throw new Error(`schema ${T} must be string`)}return k=(0,y.normalizeId)(k||u),this._checkUnique(k),this.schemas[k]=this._addSchema($,E,k,s,!0),this}addMetaSchema($,k,E=this.opts.validateSchema){return this.addSchema($,k,!0,E),this}validateSchema($,k){if(typeof $=="boolean")return!0;let E;if(E=$.$schema,E!==void 0&&typeof E!="string")throw new Error("$schema must be a string");if(E=E||this.opts.defaultMeta||this.defaultMeta(),!E)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const s=this.validate(E,$);if(!s&&k){const u="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(u);else throw new Error(u)}return s}getSchema($){let k;for(;typeof(k=w.call(this,$))=="string";)$=k;if(k===void 0){const{schemaId:E}=this.opts,s=new c.SchemaEnv({schema:{},schemaId:E});if(k=c.resolveSchema.call(this,s,$),!k)return;this.refs[$]=k}return k.validate||this._compileSchemaEnv(k)}removeSchema($){if($ instanceof RegExp)return this._removeAllSchemas(this.schemas,$),this._removeAllSchemas(this.refs,$),this;switch(typeof $){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const k=w.call(this,$);return typeof k=="object"&&this._cache.delete(k.schema),delete this.schemas[$],delete this.refs[$],this}case"object":{const k=$;this._cache.delete(k);let E=$[this.opts.schemaId];return E&&(E=(0,y.normalizeId)(E),delete this.schemas[E],delete this.refs[E]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary($){for(const k of $)this.addKeyword(k);return this}addKeyword($,k){let E;if(typeof $=="string")E=$,typeof k=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),k.keyword=E);else if(typeof $=="object"&&k===void 0){if(k=$,E=k.keyword,Array.isArray(E)&&!E.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(de.call(this,E,k),!k)return(0,m.eachItem)(E,u=>We.call(this,u)),this;it.call(this,k);const s=Ke(pe({},k),{type:(0,h.getJSONTypes)(k.type),schemaType:(0,h.getJSONTypes)(k.schemaType)});return(0,m.eachItem)(E,s.type.length===0?u=>We.call(this,u,s):u=>s.type.forEach(T=>We.call(this,u,s,T))),this}getKeyword($){const k=this.RULES.all[$];return typeof k=="object"?k.definition:!!k}removeKeyword($){const{RULES:k}=this;delete k.keywords[$],delete k.all[$];for(const E of k.rules){const s=E.rules.findIndex(u=>u.keyword===$);s>=0&&E.rules.splice(s,1)}return this}addFormat($,k){return typeof k=="string"&&(k=new RegExp(k)),this.formats[$]=k,this}errorsText($=this.errors,{separator:k=", ",dataVar:E="data"}={}){return!$||$.length===0?"No errors":$.map(s=>`${E}${s.instancePath} ${s.message}`).reduce((s,u)=>s+k+u)}$dataMetaSchema($,k){const E=this.RULES.all;$=JSON.parse(JSON.stringify($));for(const s of k){const u=s.split("/").slice(1);let T=$;for(const V of u)T=T[V];for(const V in E){const F=E[V];if(typeof F!="object")continue;const{$data:W}=F.definition,Q=T[V];W&&Q&&(T[V]=ct(Q))}}return $}_removeAllSchemas($,k){for(const E in $){const s=$[E];(!k||k.test(E))&&(typeof s=="string"?delete $[E]:s&&!s.meta&&(this._cache.delete(s.schema),delete $[E]))}}_addSchema($,k,E,s=this.opts.validateSchema,u=this.opts.addUsedSchema){let T;const{schemaId:V}=this.opts;if(typeof $=="object")T=$[V];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof $!="boolean")throw new Error("schema must be object or boolean")}let F=this._cache.get($);if(F!==void 0)return F;E=(0,y.normalizeId)(T||E);const W=y.getSchemaRefs.call(this,$,E);return F=new c.SchemaEnv({schema:$,schemaId:V,meta:k,baseId:E,localRefs:W}),this._cache.set(F.schema,F),u&&!E.startsWith("#")&&(E&&this._checkUnique(E),this.refs[E]=F),s&&this.validateSchema($,!0),F}_checkUnique($){if(this.schemas[$]||this.refs[$])throw new Error(`schema with key or id "${$}" already exists`)}_compileSchemaEnv($){if($.meta?this._compileMetaSchema($):c.compileSchema.call(this,$),!$.validate)throw new Error("ajv implementation error");return $.validate}_compileMetaSchema($){const k=this.opts;this.opts=this._metaOpts;try{c.compileSchema.call(this,$)}finally{this.opts=k}}}e.default=j,j.ValidationError=a.default,j.MissingRefError=n.default;function A(M,$,k,E="error"){for(const s in M){const u=s;u in $&&this.logger[E](`${k}: option ${s}. ${M[u]}`)}}function w(M){return M=(0,y.normalizeId)(M),this.schemas[M]||this.refs[M]}function C(){const M=this.opts.schemas;if(!!M)if(Array.isArray(M))this.addSchema(M);else for(const $ in M)this.addSchema(M[$],$)}function D(){for(const M in this.opts.formats){const $=this.opts.formats[M];$&&this.addFormat(M,$)}}function K(M){if(Array.isArray(M)){this.addVocabulary(M);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const $ in M){const k=M[$];k.keyword||(k.keyword=$),this.addKeyword(k)}}function B(){const M=pe({},this.opts);for(const $ of N)delete M[$];return M}const se={log(){},warn(){},error(){}};function Y(M){if(M===!1)return se;if(M===void 0)return console;if(M.log&&M.warn&&M.error)return M;throw new Error("logger must implement log, warn and error methods")}const Ee=/^[a-z_$][a-z0-9_$:-]*$/i;function de(M,$){const{RULES:k}=this;if((0,m.eachItem)(M,E=>{if(k.keywords[E])throw new Error(`Keyword ${E} is already defined`);if(!Ee.test(E))throw new Error(`Keyword ${E} has invalid name`)}),!!$&&$.$data&&!("code"in $||"validate"in $))throw new Error('$data keyword must have "code" or "validate" function')}function We(M,$,k){var E;const s=$==null?void 0:$.post;if(k&&s)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:u}=this;let T=s?u.post:u.rules.find(({type:F})=>F===k);if(T||(T={type:k,rules:[]},u.rules.push(T)),u.keywords[M]=!0,!$)return;const V={keyword:M,definition:Ke(pe({},$),{type:(0,h.getJSONTypes)($.type),schemaType:(0,h.getJSONTypes)($.schemaType)})};$.before?Xe.call(this,T,V,$.before):T.rules.push(V),u.all[M]=V,(E=$.implements)===null||E===void 0||E.forEach(F=>this.addKeyword(F))}function Xe(M,$,k){const E=M.rules.findIndex(s=>s.keyword===k);E>=0?M.rules.splice(E,0,$):(M.rules.push($),this.logger.warn(`rule ${k} is not defined`))}function it(M){let{metaSchema:$}=M;$!==void 0&&(M.$data&&this.opts.$data&&($=ct($)),M.validateSchema=this.compile($,!0))}const St={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function ct(M){return{anyOf:[M,St]}}})(xn);var zr={},Ur={},Lr={};Object.defineProperty(Lr,"__esModule",{value:!0});const jo={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Lr.default=jo;var st={};Object.defineProperty(st,"__esModule",{value:!0});st.callRef=st.getValidate=void 0;const ko=mr,Ln=G,$e=J,vt=Fe,qn=_e,Zt=x,Do={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:r,it:a}=e,{baseId:n,schemaEnv:o,validateName:c,opts:p,self:y}=a,{root:h}=o;if((r==="#"||r==="#/")&&n===h.baseId)return v();const m=qn.resolveRef.call(y,h,n,r);if(m===void 0)throw new ko.default(a.opts.uriResolver,n,r);if(m instanceof qn.SchemaEnv)return I(m);return R(m);function v(){if(o===h)return ar(e,c,o,o.$async);const N=t.scopeValue("root",{ref:h});return ar(e,(0,$e._)`${N}.validate`,h,h.$async)}function I(N){const _=Sa(e,N);ar(e,_,N,N.$async)}function R(N){const _=t.scopeValue("schema",p.code.source===!0?{ref:N,code:(0,$e.stringify)(N)}:{ref:N}),g=t.name("valid"),f=e.subschema({schema:N,dataTypes:[],schemaPath:$e.nil,topSchemaRef:_,errSchemaPath:r},g);e.mergeEvaluated(f),e.ok(g)}}};function Sa(e,t){const{gen:r}=e;return t.validate?r.scopeValue("validate",{ref:t.validate}):(0,$e._)`${r.scopeValue("wrapper",{ref:t})}.validate`}st.getValidate=Sa;function ar(e,t,r,a){const{gen:n,it:o}=e,{allErrors:c,schemaEnv:p,opts:y}=o,h=y.passContext?vt.default.this:$e.nil;a?m():v();function m(){if(!p.$async)throw new Error("async schema referenced by sync schema");const N=n.let("valid");n.try(()=>{n.code((0,$e._)`await ${(0,Ln.callValidateCode)(e,t,h)}`),R(t),c||n.assign(N,!0)},_=>{n.if((0,$e._)`!(${_} instanceof ${o.ValidationError})`,()=>n.throw(_)),I(_),c||n.assign(N,!1)}),e.ok(N)}function v(){e.result((0,Ln.callValidateCode)(e,t,h),()=>R(t),()=>I(t))}function I(N){const _=(0,$e._)`${N}.errors`;n.assign(vt.default.vErrors,(0,$e._)`${vt.default.vErrors} === null ? ${_} : ${vt.default.vErrors}.concat(${_})`),n.assign(vt.default.errors,(0,$e._)`${vt.default.vErrors}.length`)}function R(N){var _;if(!o.opts.unevaluated)return;const g=(_=r==null?void 0:r.validate)===null||_===void 0?void 0:_.evaluated;if(o.props!==!0)if(g&&!g.dynamicProps)g.props!==void 0&&(o.props=Zt.mergeEvaluated.props(n,g.props,o.props));else{const f=n.var("props",(0,$e._)`${N}.evaluated.props`);o.props=Zt.mergeEvaluated.props(n,f,o.props,$e.Name)}if(o.items!==!0)if(g&&!g.dynamicItems)g.items!==void 0&&(o.items=Zt.mergeEvaluated.items(n,g.items,o.items));else{const f=n.var("items",(0,$e._)`${N}.evaluated.items`);o.items=Zt.mergeEvaluated.items(n,f,o.items,$e.Name)}}}st.callRef=ar;st.default=Do;Object.defineProperty(Ur,"__esModule",{value:!0});const Ao=Lr,Mo=st,Vo=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",Ao.default,Mo.default];Ur.default=Vo;var qr={},Kr={};Object.defineProperty(Kr,"__esModule",{value:!0});const cr=J,Ge=cr.operators,lr={maximum:{okStr:"<=",ok:Ge.LTE,fail:Ge.GT},minimum:{okStr:">=",ok:Ge.GTE,fail:Ge.LT},exclusiveMaximum:{okStr:"<",ok:Ge.LT,fail:Ge.GTE},exclusiveMinimum:{okStr:">",ok:Ge.GT,fail:Ge.LTE}},Fo={message:({keyword:e,schemaCode:t})=>(0,cr.str)`must be ${lr[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>(0,cr._)`{comparison: ${lr[e].okStr}, limit: ${t}}`},zo={keyword:Object.keys(lr),type:"number",schemaType:"number",$data:!0,error:Fo,code(e){const{keyword:t,data:r,schemaCode:a}=e;e.fail$data((0,cr._)`${r} ${lr[t].fail} ${a} || isNaN(${r})`)}};Kr.default=zo;var Hr={};Object.defineProperty(Hr,"__esModule",{value:!0});const Ft=J,Uo={message:({schemaCode:e})=>(0,Ft.str)`must be multiple of ${e}`,params:({schemaCode:e})=>(0,Ft._)`{multipleOf: ${e}}`},Lo={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:Uo,code(e){const{gen:t,data:r,schemaCode:a,it:n}=e,o=n.opts.multipleOfPrecision,c=t.let("res"),p=o?(0,Ft._)`Math.abs(Math.round(${c}) - ${c}) > 1e-${o}`:(0,Ft._)`${c} !== parseInt(${c})`;e.fail$data((0,Ft._)`(${a} === 0 || (${c} = ${r}/${a}, ${p}))`)}};Hr.default=Lo;var Gr={},Jr={};Object.defineProperty(Jr,"__esModule",{value:!0});function Pa(e){const t=e.length;let r=0,a=0,n;for(;a<t;)r++,n=e.charCodeAt(a++),n>=55296&&n<=56319&&a<t&&(n=e.charCodeAt(a),(n&64512)===56320&&a++);return r}Jr.default=Pa;Pa.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(Gr,"__esModule",{value:!0});const rt=J,qo=x,Ko=Jr,Ho={message({keyword:e,schemaCode:t}){const r=e==="maxLength"?"more":"fewer";return(0,rt.str)`must NOT have ${r} than ${t} characters`},params:({schemaCode:e})=>(0,rt._)`{limit: ${e}}`},Go={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:Ho,code(e){const{keyword:t,data:r,schemaCode:a,it:n}=e,o=t==="maxLength"?rt.operators.GT:rt.operators.LT,c=n.opts.unicode===!1?(0,rt._)`${r}.length`:(0,rt._)`${(0,qo.useFunc)(e.gen,Ko.default)}(${r})`;e.fail$data((0,rt._)`${c} ${o} ${a}`)}};Gr.default=Go;var Br={};Object.defineProperty(Br,"__esModule",{value:!0});const Jo=G,ur=J,Bo={message:({schemaCode:e})=>(0,ur.str)`must match pattern "${e}"`,params:({schemaCode:e})=>(0,ur._)`{pattern: ${e}}`},Wo={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:Bo,code(e){const{data:t,$data:r,schema:a,schemaCode:n,it:o}=e,c=o.opts.unicodeRegExp?"u":"",p=r?(0,ur._)`(new RegExp(${n}, ${c}))`:(0,Jo.usePattern)(e,a);e.fail$data((0,ur._)`!${p}.test(${t})`)}};Br.default=Wo;var Wr={};Object.defineProperty(Wr,"__esModule",{value:!0});const zt=J,Xo={message({keyword:e,schemaCode:t}){const r=e==="maxProperties"?"more":"fewer";return(0,zt.str)`must NOT have ${r} than ${t} properties`},params:({schemaCode:e})=>(0,zt._)`{limit: ${e}}`},Qo={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:Xo,code(e){const{keyword:t,data:r,schemaCode:a}=e,n=t==="maxProperties"?zt.operators.GT:zt.operators.LT;e.fail$data((0,zt._)`Object.keys(${r}).length ${n} ${a}`)}};Wr.default=Qo;var Xr={};Object.defineProperty(Xr,"__esModule",{value:!0});const At=G,Ut=J,Yo=x,Zo={message:({params:{missingProperty:e}})=>(0,Ut.str)`must have required property '${e}'`,params:({params:{missingProperty:e}})=>(0,Ut._)`{missingProperty: ${e}}`},xo={keyword:"required",type:"object",schemaType:"array",$data:!0,error:Zo,code(e){const{gen:t,schema:r,schemaCode:a,data:n,$data:o,it:c}=e,{opts:p}=c;if(!o&&r.length===0)return;const y=r.length>=p.loopRequired;if(c.allErrors?h():m(),p.strictRequired){const R=e.parentSchema.properties,{definedProperties:N}=e.it;for(const _ of r)if((R==null?void 0:R[_])===void 0&&!N.has(_)){const g=c.schemaEnv.baseId+c.errSchemaPath,f=`required property "${_}" is not defined at "${g}" (strictRequired)`;(0,Yo.checkStrictMode)(c,f,c.opts.strictRequired)}}function h(){if(y||o)e.block$data(Ut.nil,v);else for(const R of r)(0,At.checkReportMissingProp)(e,R)}function m(){const R=t.let("missing");if(y||o){const N=t.let("valid",!0);e.block$data(N,()=>I(R,N)),e.ok(N)}else t.if((0,At.checkMissingProp)(e,r,R)),(0,At.reportMissingProp)(e,R),t.else()}function v(){t.forOf("prop",a,R=>{e.setParams({missingProperty:R}),t.if((0,At.noPropertyInData)(t,n,R,p.ownProperties),()=>e.error())})}function I(R,N){e.setParams({missingProperty:R}),t.forOf(R,a,()=>{t.assign(N,(0,At.propertyInData)(t,n,R,p.ownProperties)),t.if((0,Ut.not)(N),()=>{e.error(),t.break()})},Ut.nil)}}};Xr.default=xo;var Qr={};Object.defineProperty(Qr,"__esModule",{value:!0});const Lt=J,ei={message({keyword:e,schemaCode:t}){const r=e==="maxItems"?"more":"fewer";return(0,Lt.str)`must NOT have ${r} than ${t} items`},params:({schemaCode:e})=>(0,Lt._)`{limit: ${e}}`},ti={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:ei,code(e){const{keyword:t,data:r,schemaCode:a}=e,n=t==="maxItems"?Lt.operators.GT:Lt.operators.LT;e.fail$data((0,Lt._)`${r}.length ${n} ${a}`)}};Qr.default=ti;var Yr={},Bt={};Object.defineProperty(Bt,"__esModule",{value:!0});const Na=ia;Na.code='require("ajv/dist/runtime/equal").default';Bt.default=Na;Object.defineProperty(Yr,"__esModule",{value:!0});const Er=Jt,he=J,ri=x,ni=Bt,ai={message:({params:{i:e,j:t}})=>(0,he.str)`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>(0,he._)`{i: ${e}, j: ${t}}`},si={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:ai,code(e){const{gen:t,data:r,$data:a,schema:n,parentSchema:o,schemaCode:c,it:p}=e;if(!a&&!n)return;const y=t.let("valid"),h=o.items?(0,Er.getSchemaTypes)(o.items):[];e.block$data(y,m,(0,he._)`${c} === false`),e.ok(y);function m(){const N=t.let("i",(0,he._)`${r}.length`),_=t.let("j");e.setParams({i:N,j:_}),t.assign(y,!0),t.if((0,he._)`${N} > 1`,()=>(v()?I:R)(N,_))}function v(){return h.length>0&&!h.some(N=>N==="object"||N==="array")}function I(N,_){const g=t.name("item"),f=(0,Er.checkDataTypes)(h,g,p.opts.strictNumbers,Er.DataType.Wrong),b=t.const("indices",(0,he._)`{}`);t.for((0,he._)`;${N}--;`,()=>{t.let(g,(0,he._)`${r}[${N}]`),t.if(f,(0,he._)`continue`),h.length>1&&t.if((0,he._)`typeof ${g} == "string"`,(0,he._)`${g} += "_"`),t.if((0,he._)`typeof ${b}[${g}] == "number"`,()=>{t.assign(_,(0,he._)`${b}[${g}]`),e.error(),t.assign(y,!1).break()}).code((0,he._)`${b}[${g}] = ${N}`)})}function R(N,_){const g=(0,ri.useFunc)(t,ni.default),f=t.name("outer");t.label(f).for((0,he._)`;${N}--;`,()=>t.for((0,he._)`${_} = ${N}; ${_}--;`,()=>t.if((0,he._)`${g}(${r}[${N}], ${r}[${_}])`,()=>{e.error(),t.assign(y,!1).break(f)})))}}};Yr.default=si;var Zr={};Object.defineProperty(Zr,"__esModule",{value:!0});const Tr=J,oi=x,ii=Bt,ci={message:"must be equal to constant",params:({schemaCode:e})=>(0,Tr._)`{allowedValue: ${e}}`},li={keyword:"const",$data:!0,error:ci,code(e){const{gen:t,data:r,$data:a,schemaCode:n,schema:o}=e;a||o&&typeof o=="object"?e.fail$data((0,Tr._)`!${(0,oi.useFunc)(t,ii.default)}(${r}, ${n})`):e.fail((0,Tr._)`${o} !== ${r}`)}};Zr.default=li;var xr={};Object.defineProperty(xr,"__esModule",{value:!0});const Mt=J,ui=x,di=Bt,fi={message:"must be equal to one of the allowed values",params:({schemaCode:e})=>(0,Mt._)`{allowedValues: ${e}}`},hi={keyword:"enum",schemaType:"array",$data:!0,error:fi,code(e){const{gen:t,data:r,$data:a,schema:n,schemaCode:o,it:c}=e;if(!a&&n.length===0)throw new Error("enum must have non-empty array");const p=n.length>=c.opts.loopEnum;let y;const h=()=>y!=null?y:y=(0,ui.useFunc)(t,di.default);let m;if(p||a)m=t.let("valid"),e.block$data(m,v);else{if(!Array.isArray(n))throw new Error("ajv implementation error");const R=t.const("vSchema",o);m=(0,Mt.or)(...n.map((N,_)=>I(R,_)))}e.pass(m);function v(){t.assign(m,!1),t.forOf("v",o,R=>t.if((0,Mt._)`${h()}(${r}, ${R})`,()=>t.assign(m,!0).break()))}function I(R,N){const _=n[N];return typeof _=="object"&&_!==null?(0,Mt._)`${h()}(${r}, ${R}[${N}])`:(0,Mt._)`${r} === ${_}`}}};xr.default=hi;Object.defineProperty(qr,"__esModule",{value:!0});const mi=Kr,pi=Hr,yi=Gr,vi=Br,gi=Wr,$i=Xr,_i=Qr,wi=Yr,Ei=Zr,bi=xr,Si=[mi.default,pi.default,yi.default,vi.default,gi.default,$i.default,_i.default,wi.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},Ei.default,bi.default];qr.default=Si;var en={},Et={};Object.defineProperty(Et,"__esModule",{value:!0});Et.validateAdditionalItems=void 0;const nt=J,Rr=x,Pi={message:({params:{len:e}})=>(0,nt.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,nt._)`{limit: ${e}}`},Ni={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:Pi,code(e){const{parentSchema:t,it:r}=e,{items:a}=t;if(!Array.isArray(a)){(0,Rr.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}Oa(e,a)}};function Oa(e,t){const{gen:r,schema:a,data:n,keyword:o,it:c}=e;c.items=!0;const p=r.const("len",(0,nt._)`${n}.length`);if(a===!1)e.setParams({len:t.length}),e.pass((0,nt._)`${p} <= ${t.length}`);else if(typeof a=="object"&&!(0,Rr.alwaysValidSchema)(c,a)){const h=r.var("valid",(0,nt._)`${p} <= ${t.length}`);r.if((0,nt.not)(h),()=>y(h)),e.ok(h)}function y(h){r.forRange("i",t.length,p,m=>{e.subschema({keyword:o,dataProp:m,dataPropType:Rr.Type.Num},h),c.allErrors||r.if((0,nt.not)(h),()=>r.break())})}}Et.validateAdditionalItems=Oa;Et.default=Ni;var tn={},bt={};Object.defineProperty(bt,"__esModule",{value:!0});bt.validateTuple=void 0;const Kn=J,sr=x,Oi=G,Ci={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:r}=e;if(Array.isArray(t))return Ca(e,"additionalItems",t);r.items=!0,!(0,sr.alwaysValidSchema)(r,t)&&e.ok((0,Oi.validateArray)(e))}};function Ca(e,t,r=e.schema){const{gen:a,parentSchema:n,data:o,keyword:c,it:p}=e;m(n),p.opts.unevaluated&&r.length&&p.items!==!0&&(p.items=sr.mergeEvaluated.items(a,r.length,p.items));const y=a.name("valid"),h=a.const("len",(0,Kn._)`${o}.length`);r.forEach((v,I)=>{(0,sr.alwaysValidSchema)(p,v)||(a.if((0,Kn._)`${h} > ${I}`,()=>e.subschema({keyword:c,schemaProp:I,dataProp:I},y)),e.ok(y))});function m(v){const{opts:I,errSchemaPath:R}=p,N=r.length,_=N===v.minItems&&(N===v.maxItems||v[t]===!1);if(I.strictTuples&&!_){const g=`"${c}" is ${N}-tuple, but minItems or maxItems/${t} are not specified or different at path "${R}"`;(0,sr.checkStrictMode)(p,g,I.strictTuples)}}}bt.validateTuple=Ca;bt.default=Ci;Object.defineProperty(tn,"__esModule",{value:!0});const Ti=bt,Ri={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,Ti.validateTuple)(e,"items")};tn.default=Ri;var rn={};Object.defineProperty(rn,"__esModule",{value:!0});const Hn=J,Ii=x,ji=G,ki=Et,Di={message:({params:{len:e}})=>(0,Hn.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,Hn._)`{limit: ${e}}`},Ai={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:Di,code(e){const{schema:t,parentSchema:r,it:a}=e,{prefixItems:n}=r;a.items=!0,!(0,Ii.alwaysValidSchema)(a,t)&&(n?(0,ki.validateAdditionalItems)(e,n):e.ok((0,ji.validateArray)(e)))}};rn.default=Ai;var nn={};Object.defineProperty(nn,"__esModule",{value:!0});const Pe=J,xt=x,Mi={message:({params:{min:e,max:t}})=>t===void 0?(0,Pe.str)`must contain at least ${e} valid item(s)`:(0,Pe.str)`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>t===void 0?(0,Pe._)`{minContains: ${e}}`:(0,Pe._)`{minContains: ${e}, maxContains: ${t}}`},Vi={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:Mi,code(e){const{gen:t,schema:r,parentSchema:a,data:n,it:o}=e;let c,p;const{minContains:y,maxContains:h}=a;o.opts.next?(c=y===void 0?1:y,p=h):c=1;const m=t.const("len",(0,Pe._)`${n}.length`);if(e.setParams({min:c,max:p}),p===void 0&&c===0){(0,xt.checkStrictMode)(o,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(p!==void 0&&c>p){(0,xt.checkStrictMode)(o,'"minContains" > "maxContains" is always invalid'),e.fail();return}if((0,xt.alwaysValidSchema)(o,r)){let _=(0,Pe._)`${m} >= ${c}`;p!==void 0&&(_=(0,Pe._)`${_} && ${m} <= ${p}`),e.pass(_);return}o.items=!0;const v=t.name("valid");p===void 0&&c===1?R(v,()=>t.if(v,()=>t.break())):c===0?(t.let(v,!0),p!==void 0&&t.if((0,Pe._)`${n}.length > 0`,I)):(t.let(v,!1),I()),e.result(v,()=>e.reset());function I(){const _=t.name("_valid"),g=t.let("count",0);R(_,()=>t.if(_,()=>N(g)))}function R(_,g){t.forRange("i",0,m,f=>{e.subschema({keyword:"contains",dataProp:f,dataPropType:xt.Type.Num,compositeRule:!0},_),g()})}function N(_){t.code((0,Pe._)`${_}++`),p===void 0?t.if((0,Pe._)`${_} >= ${c}`,()=>t.assign(v,!0).break()):(t.if((0,Pe._)`${_} > ${p}`,()=>t.assign(v,!1).break()),c===1?t.assign(v,!0):t.if((0,Pe._)`${_} >= ${c}`,()=>t.assign(v,!0)))}}};nn.default=Vi;var Ta={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=J,r=x,a=G;e.error={message:({params:{property:y,depsCount:h,deps:m}})=>{const v=h===1?"property":"properties";return(0,t.str)`must have ${v} ${m} when property ${y} is present`},params:({params:{property:y,depsCount:h,deps:m,missingProperty:v}})=>(0,t._)`{property: ${y},
    missingProperty: ${v},
    depsCount: ${h},
    deps: ${m}}`};const n={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(y){const[h,m]=o(y);c(y,h),p(y,m)}};function o({schema:y}){const h={},m={};for(const v in y){if(v==="__proto__")continue;const I=Array.isArray(y[v])?h:m;I[v]=y[v]}return[h,m]}function c(y,h=y.schema){const{gen:m,data:v,it:I}=y;if(Object.keys(h).length===0)return;const R=m.let("missing");for(const N in h){const _=h[N];if(_.length===0)continue;const g=(0,a.propertyInData)(m,v,N,I.opts.ownProperties);y.setParams({property:N,depsCount:_.length,deps:_.join(", ")}),I.allErrors?m.if(g,()=>{for(const f of _)(0,a.checkReportMissingProp)(y,f)}):(m.if((0,t._)`${g} && (${(0,a.checkMissingProp)(y,_,R)})`),(0,a.reportMissingProp)(y,R),m.else())}}e.validatePropertyDeps=c;function p(y,h=y.schema){const{gen:m,data:v,keyword:I,it:R}=y,N=m.name("valid");for(const _ in h)(0,r.alwaysValidSchema)(R,h[_])||(m.if((0,a.propertyInData)(m,v,_,R.opts.ownProperties),()=>{const g=y.subschema({keyword:I,schemaProp:_},N);y.mergeValidEvaluated(g,N)},()=>m.var(N,!0)),y.ok(N))}e.validateSchemaDeps=p,e.default=n})(Ta);var an={};Object.defineProperty(an,"__esModule",{value:!0});const Ra=J,Fi=x,zi={message:"property name must be valid",params:({params:e})=>(0,Ra._)`{propertyName: ${e.propertyName}}`},Ui={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:zi,code(e){const{gen:t,schema:r,data:a,it:n}=e;if((0,Fi.alwaysValidSchema)(n,r))return;const o=t.name("valid");t.forIn("key",a,c=>{e.setParams({propertyName:c}),e.subschema({keyword:"propertyNames",data:c,dataTypes:["string"],propertyName:c,compositeRule:!0},o),t.if((0,Ra.not)(o),()=>{e.error(!0),n.allErrors||t.break()})}),e.ok(o)}};an.default=Ui;var vr={};Object.defineProperty(vr,"__esModule",{value:!0});const er=G,Oe=J,Li=Fe,tr=x,qi={message:"must NOT have additional properties",params:({params:e})=>(0,Oe._)`{additionalProperty: ${e.additionalProperty}}`},Ki={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:qi,code(e){const{gen:t,schema:r,parentSchema:a,data:n,errsCount:o,it:c}=e;if(!o)throw new Error("ajv implementation error");const{allErrors:p,opts:y}=c;if(c.props=!0,y.removeAdditional!=="all"&&(0,tr.alwaysValidSchema)(c,r))return;const h=(0,er.allSchemaProperties)(a.properties),m=(0,er.allSchemaProperties)(a.patternProperties);v(),e.ok((0,Oe._)`${o} === ${Li.default.errors}`);function v(){t.forIn("key",n,g=>{!h.length&&!m.length?N(g):t.if(I(g),()=>N(g))})}function I(g){let f;if(h.length>8){const b=(0,tr.schemaRefOrVal)(c,a.properties,"properties");f=(0,er.isOwnProperty)(t,b,g)}else h.length?f=(0,Oe.or)(...h.map(b=>(0,Oe._)`${g} === ${b}`)):f=Oe.nil;return m.length&&(f=(0,Oe.or)(f,...m.map(b=>(0,Oe._)`${(0,er.usePattern)(e,b)}.test(${g})`))),(0,Oe.not)(f)}function R(g){t.code((0,Oe._)`delete ${n}[${g}]`)}function N(g){if(y.removeAdditional==="all"||y.removeAdditional&&r===!1){R(g);return}if(r===!1){e.setParams({additionalProperty:g}),e.error(),p||t.break();return}if(typeof r=="object"&&!(0,tr.alwaysValidSchema)(c,r)){const f=t.name("valid");y.removeAdditional==="failing"?(_(g,f,!1),t.if((0,Oe.not)(f),()=>{e.reset(),R(g)})):(_(g,f),p||t.if((0,Oe.not)(f),()=>t.break()))}}function _(g,f,b){const O={keyword:"additionalProperties",dataProp:g,dataPropType:tr.Type.Str};b===!1&&Object.assign(O,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(O,f)}}};vr.default=Ki;var sn={};Object.defineProperty(sn,"__esModule",{value:!0});const Hi=Te,Gn=G,br=x,Jn=vr,Gi={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,parentSchema:a,data:n,it:o}=e;o.opts.removeAdditional==="all"&&a.additionalProperties===void 0&&Jn.default.code(new Hi.KeywordCxt(o,Jn.default,"additionalProperties"));const c=(0,Gn.allSchemaProperties)(r);for(const v of c)o.definedProperties.add(v);o.opts.unevaluated&&c.length&&o.props!==!0&&(o.props=br.mergeEvaluated.props(t,(0,br.toHash)(c),o.props));const p=c.filter(v=>!(0,br.alwaysValidSchema)(o,r[v]));if(p.length===0)return;const y=t.name("valid");for(const v of p)h(v)?m(v):(t.if((0,Gn.propertyInData)(t,n,v,o.opts.ownProperties)),m(v),o.allErrors||t.else().var(y,!0),t.endIf()),e.it.definedProperties.add(v),e.ok(y);function h(v){return o.opts.useDefaults&&!o.compositeRule&&r[v].default!==void 0}function m(v){e.subschema({keyword:"properties",schemaProp:v,dataProp:v},y)}}};sn.default=Gi;var on={};Object.defineProperty(on,"__esModule",{value:!0});const Bn=G,rr=J,Wn=x,Xn=x,Ji={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,data:a,parentSchema:n,it:o}=e,{opts:c}=o,p=(0,Bn.allSchemaProperties)(r),y=p.filter(_=>(0,Wn.alwaysValidSchema)(o,r[_]));if(p.length===0||y.length===p.length&&(!o.opts.unevaluated||o.props===!0))return;const h=c.strictSchema&&!c.allowMatchingProperties&&n.properties,m=t.name("valid");o.props!==!0&&!(o.props instanceof rr.Name)&&(o.props=(0,Xn.evaluatedPropsToName)(t,o.props));const{props:v}=o;I();function I(){for(const _ of p)h&&R(_),o.allErrors?N(_):(t.var(m,!0),N(_),t.if(m))}function R(_){for(const g in h)new RegExp(_).test(g)&&(0,Wn.checkStrictMode)(o,`property ${g} matches pattern ${_} (use allowMatchingProperties)`)}function N(_){t.forIn("key",a,g=>{t.if((0,rr._)`${(0,Bn.usePattern)(e,_)}.test(${g})`,()=>{const f=y.includes(_);f||e.subschema({keyword:"patternProperties",schemaProp:_,dataProp:g,dataPropType:Xn.Type.Str},m),o.opts.unevaluated&&v!==!0?t.assign((0,rr._)`${v}[${g}]`,!0):!f&&!o.allErrors&&t.if((0,rr.not)(m),()=>t.break())})})}}};on.default=Ji;var cn={};Object.defineProperty(cn,"__esModule",{value:!0});const Bi=x,Wi={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:r,it:a}=e;if((0,Bi.alwaysValidSchema)(a,r)){e.fail();return}const n=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},n),e.failResult(n,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}};cn.default=Wi;var ln={};Object.defineProperty(ln,"__esModule",{value:!0});const Xi=G,Qi={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Xi.validateUnion,error:{message:"must match a schema in anyOf"}};ln.default=Qi;var un={};Object.defineProperty(un,"__esModule",{value:!0});const or=J,Yi=x,Zi={message:"must match exactly one schema in oneOf",params:({params:e})=>(0,or._)`{passingSchemas: ${e.passing}}`},xi={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:Zi,code(e){const{gen:t,schema:r,parentSchema:a,it:n}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(n.opts.discriminator&&a.discriminator)return;const o=r,c=t.let("valid",!1),p=t.let("passing",null),y=t.name("_valid");e.setParams({passing:p}),t.block(h),e.result(c,()=>e.reset(),()=>e.error(!0));function h(){o.forEach((m,v)=>{let I;(0,Yi.alwaysValidSchema)(n,m)?t.var(y,!0):I=e.subschema({keyword:"oneOf",schemaProp:v,compositeRule:!0},y),v>0&&t.if((0,or._)`${y} && ${c}`).assign(c,!1).assign(p,(0,or._)`[${p}, ${v}]`).else(),t.if(y,()=>{t.assign(c,!0),t.assign(p,v),I&&e.mergeEvaluated(I,or.Name)})})}}};un.default=xi;var dn={};Object.defineProperty(dn,"__esModule",{value:!0});const ec=x,tc={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:r,it:a}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");const n=t.name("valid");r.forEach((o,c)=>{if((0,ec.alwaysValidSchema)(a,o))return;const p=e.subschema({keyword:"allOf",schemaProp:c},n);e.ok(n),e.mergeEvaluated(p)})}};dn.default=tc;var fn={};Object.defineProperty(fn,"__esModule",{value:!0});const dr=J,Ia=x,rc={message:({params:e})=>(0,dr.str)`must match "${e.ifClause}" schema`,params:({params:e})=>(0,dr._)`{failingKeyword: ${e.ifClause}}`},nc={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:rc,code(e){const{gen:t,parentSchema:r,it:a}=e;r.then===void 0&&r.else===void 0&&(0,Ia.checkStrictMode)(a,'"if" without "then" and "else" is ignored');const n=Qn(a,"then"),o=Qn(a,"else");if(!n&&!o)return;const c=t.let("valid",!0),p=t.name("_valid");if(y(),e.reset(),n&&o){const m=t.let("ifClause");e.setParams({ifClause:m}),t.if(p,h("then",m),h("else",m))}else n?t.if(p,h("then")):t.if((0,dr.not)(p),h("else"));e.pass(c,()=>e.error(!0));function y(){const m=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},p);e.mergeEvaluated(m)}function h(m,v){return()=>{const I=e.subschema({keyword:m},p);t.assign(c,p),e.mergeValidEvaluated(I,c),v?t.assign(v,(0,dr._)`${m}`):e.setParams({ifClause:m})}}}};function Qn(e,t){const r=e.schema[t];return r!==void 0&&!(0,Ia.alwaysValidSchema)(e,r)}fn.default=nc;var hn={};Object.defineProperty(hn,"__esModule",{value:!0});const ac=x,sc={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:r}){t.if===void 0&&(0,ac.checkStrictMode)(r,`"${e}" without "if" is ignored`)}};hn.default=sc;Object.defineProperty(en,"__esModule",{value:!0});const oc=Et,ic=tn,cc=bt,lc=rn,uc=nn,dc=Ta,fc=an,hc=vr,mc=sn,pc=on,yc=cn,vc=ln,gc=un,$c=dn,_c=fn,wc=hn;function Ec(e=!1){const t=[yc.default,vc.default,gc.default,$c.default,_c.default,wc.default,fc.default,hc.default,dc.default,mc.default,pc.default];return e?t.push(ic.default,lc.default):t.push(oc.default,cc.default),t.push(uc.default),t}en.default=Ec;var mn={},pn={};Object.defineProperty(pn,"__esModule",{value:!0});const le=J,bc={message:({schemaCode:e})=>(0,le.str)`must match format "${e}"`,params:({schemaCode:e})=>(0,le._)`{format: ${e}}`},Sc={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:bc,code(e,t){const{gen:r,data:a,$data:n,schema:o,schemaCode:c,it:p}=e,{opts:y,errSchemaPath:h,schemaEnv:m,self:v}=p;if(!y.validateFormats)return;n?I():R();function I(){const N=r.scopeValue("formats",{ref:v.formats,code:y.code.formats}),_=r.const("fDef",(0,le._)`${N}[${c}]`),g=r.let("fType"),f=r.let("format");r.if((0,le._)`typeof ${_} == "object" && !(${_} instanceof RegExp)`,()=>r.assign(g,(0,le._)`${_}.type || "string"`).assign(f,(0,le._)`${_}.validate`),()=>r.assign(g,(0,le._)`"string"`).assign(f,_)),e.fail$data((0,le.or)(b(),O()));function b(){return y.strictSchema===!1?le.nil:(0,le._)`${c} && !${f}`}function O(){const j=m.$async?(0,le._)`(${_}.async ? await ${f}(${a}) : ${f}(${a}))`:(0,le._)`${f}(${a})`,A=(0,le._)`(typeof ${f} == "function" ? ${j} : ${f}.test(${a}))`;return(0,le._)`${f} && ${f} !== true && ${g} === ${t} && !${A}`}}function R(){const N=v.formats[o];if(!N){b();return}if(N===!0)return;const[_,g,f]=O(N);_===t&&e.pass(j());function b(){if(y.strictSchema===!1){v.logger.warn(A());return}throw new Error(A());function A(){return`unknown format "${o}" ignored in schema at path "${h}"`}}function O(A){const w=A instanceof RegExp?(0,le.regexpCode)(A):y.code.formats?(0,le._)`${y.code.formats}${(0,le.getProperty)(o)}`:void 0,C=r.scopeValue("formats",{key:o,ref:A,code:w});return typeof A=="object"&&!(A instanceof RegExp)?[A.type||"string",A.validate,(0,le._)`${C}.validate`]:["string",A,C]}function j(){if(typeof N=="object"&&!(N instanceof RegExp)&&N.async){if(!m.$async)throw new Error("async format in sync schema");return(0,le._)`await ${f}(${a})`}return typeof g=="function"?(0,le._)`${f}(${a})`:(0,le._)`${f}.test(${a})`}}}};pn.default=Sc;Object.defineProperty(mn,"__esModule",{value:!0});const Pc=pn,Nc=[Pc.default];mn.default=Nc;var wt={};Object.defineProperty(wt,"__esModule",{value:!0});wt.contentVocabulary=wt.metadataVocabulary=void 0;wt.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];wt.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(zr,"__esModule",{value:!0});const Oc=Ur,Cc=qr,Tc=en,Rc=mn,Yn=wt,Ic=[Oc.default,Cc.default,(0,Tc.default)(),Rc.default,Yn.metadataVocabulary,Yn.contentVocabulary];zr.default=Ic;var yn={},ja={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DiscrError=void 0,function(t){t.Tag="tag",t.Mapping="mapping"}(e.DiscrError||(e.DiscrError={}))})(ja);Object.defineProperty(yn,"__esModule",{value:!0});const gt=J,Ir=ja,Zn=_e,jc=x,kc={message:({params:{discrError:e,tagName:t}})=>e===Ir.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:r}})=>(0,gt._)`{error: ${e}, tag: ${r}, tagValue: ${t}}`},Dc={keyword:"discriminator",type:"object",schemaType:"object",error:kc,code(e){const{gen:t,data:r,schema:a,parentSchema:n,it:o}=e,{oneOf:c}=n;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");const p=a.propertyName;if(typeof p!="string")throw new Error("discriminator: requires propertyName");if(a.mapping)throw new Error("discriminator: mapping is not supported");if(!c)throw new Error("discriminator: requires oneOf keyword");const y=t.let("valid",!1),h=t.const("tag",(0,gt._)`${r}${(0,gt.getProperty)(p)}`);t.if((0,gt._)`typeof ${h} == "string"`,()=>m(),()=>e.error(!1,{discrError:Ir.DiscrError.Tag,tag:h,tagName:p})),e.ok(y);function m(){const R=I();t.if(!1);for(const N in R)t.elseIf((0,gt._)`${h} === ${N}`),t.assign(y,v(R[N]));t.else(),e.error(!1,{discrError:Ir.DiscrError.Mapping,tag:h,tagName:p}),t.endIf()}function v(R){const N=t.name("valid"),_=e.subschema({keyword:"oneOf",schemaProp:R},N);return e.mergeEvaluated(_,gt.Name),N}function I(){var R;const N={},_=f(n);let g=!0;for(let j=0;j<c.length;j++){let A=c[j];(A==null?void 0:A.$ref)&&!(0,jc.schemaHasRulesButRef)(A,o.self.RULES)&&(A=Zn.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,A==null?void 0:A.$ref),A instanceof Zn.SchemaEnv&&(A=A.schema));const w=(R=A==null?void 0:A.properties)===null||R===void 0?void 0:R[p];if(typeof w!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${p}"`);g=g&&(_||f(A)),b(w,j)}if(!g)throw new Error(`discriminator: "${p}" must be required`);return N;function f({required:j}){return Array.isArray(j)&&j.includes(p)}function b(j,A){if(j.const)O(j.const,A);else if(j.enum)for(const w of j.enum)O(w,A);else throw new Error(`discriminator: "properties/${p}" must have "const" or "enum"`)}function O(j,A){if(typeof j!="string"||j in N)throw new Error(`discriminator: "${p}" values must be unique strings`);N[j]=A}}}};yn.default=Dc;const Ac="http://json-schema.org/draft-07/schema#",Mc="http://json-schema.org/draft-07/schema#",Vc="Core schema meta-schema",Fc={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},zc=["object","boolean"],Uc={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}};var Lc={$schema:Ac,$id:Mc,title:Vc,definitions:Fc,type:zc,properties:Uc,default:!0};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;const r=xn,a=zr,n=yn,o=Lc,c=["/properties"],p="http://json-schema.org/draft-07/schema";class y extends r.default{_addVocabularies(){super._addVocabularies(),a.default.forEach(I=>this.addVocabulary(I)),this.opts.discriminator&&this.addKeyword(n.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const I=this.opts.$data?this.$dataMetaSchema(o,c):o;this.addMetaSchema(I,p,!1),this.refs["http://json-schema.org/schema"]=p}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(p)?p:void 0)}}e.exports=t=y,Object.defineProperty(t,"__esModule",{value:!0}),t.default=y;var h=Te;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return h.KeywordCxt}});var m=J;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return m._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return m.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return m.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return m.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return m.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return m.CodeGen}})})(Pr,Pr.exports);var qc=xa(Pr.exports);async function ot(e){return fetch(e).then(t=>t.json())}function ue(e){const t=document.createElement("pre");t.innerHTML=e,document.getElementById("app").appendChild(t)}function Kc(e){return document.createElement("div").appendChild(document.createTextNode(e)).parentNode.innerHTML}function Ht(e,t){let r=Kc(JSON.stringify(e,null,2));if(!t){ue(r);return}const a=document.createElement("details"),n=document.createElement("summary");n.innerHTML=t,a.appendChild(n);const o=document.createElement("pre");o.innerHTML=r,a.appendChild(o),document.getElementById("app").appendChild(a)}let Sr={};async function qt(e,t="image"){let r=t+e;if(!Sr[r]){const a=`https://raw.githubusercontent.com/ome/ngff/main/${e}/schemas/${t}.schema`;ue("Loading schema... "+a);const n=await ot(a);delete n.$schema,Sr[r]=n}return Sr[r]}function Hc(e){return[0,2,4].map(t=>parseInt(e.slice(t,t+2),16))}async function Gc(e,t){return t=t.map(n=>{if(typeof n=="string"){let o=n.split(":").map(c=>parseInt(c));return console.log("startStop",o,n.split(":")),o.length===2?Xa(...o):o[0]}return n}),console.log("region",t),await(await Qa({store:e})).get(t)}function Jc(e){return new Array(e).fill(0).map((t,r)=>r)}function Bc(e,t,r){const a=e[0].shape[0],n=e[0].shape[1],o=new Uint8ClampedArray(4*a*n).fill(0);let c=0;for(let p=0;p<a;p++)for(let y=0;y<n;y++){for(let h=0;h<e.length;h++){let m=e[h].data,v=t[h],I=r[h],N=(m[p][y]-I[0])/(I[1]-I[0]);for(let _=0;_<3;_++)if(v[_]>0){let g=N*v[_]<<0;o[c+_]=Math.max(o[c+_],g)}}o[c+3]=255,c+=4}return o}async function Wc(e,t,r,a){const n=r.length,o=r[n-1],c=r[n-2];if(o>512||c>512)return;let p=t.indexOf("c"),y=r[p]||1;console.log("sizeC",y),console.log("axesNames",t);let h=Qc(t,r);console.log("channelDim",p),console.log("dims",h);let m=Jc(y).map(b=>{let O=[...h];return O[p]=b,O});console.log("slices",m);let v=[],I=[];a&&(v=a.map(b=>[b.window.start,b.window.end]),I=a.map(b=>Hc(b.color)));const R=await Promise.all(m.map(b=>Gc(e,b)));console.log("planes",R);const N=R[0].data,_=R[0].shape[0],g=R[0].shape[1];console.log("data.length",N.length,N.length*4),console.log("channelColors",I),console.log("channelRanges",v);const f=Bc(R,I,v);console.log("rgba",f),Xc(f,g,_)}function Xc(e,t,r){const a=new ImageData(e,t,r);let n=document.createElement("canvas");n.width=t,n.height=r,document.getElementById("app").appendChild(n);var o=n.getContext("2d");o.putImageData(a,0,0)}function Qc(e,t){return e.map((r,a)=>{if(r==="z"){let n=t[a];return parseInt(n/2)}return r==="x"||r==="y"?null:0})}const Yc=new qc({strict:!1}),Zc="0.4";function vn(e,t,r=!0){const a=Yc.compile(e),n=a(t);return n?r&&ue("<div style='color: green; font-size:24px; border:solid green 1px; padding: 10px; border-radius: 5px; background: #eeffee'>VALID!</span>"):(ue("<div style='color: red; font-size:24px; border:solid red 1px; padding: 10px; border-radius: 5px; background: #ffeeee'>NOT VALID!</span>"),a.errors.forEach(o=>Ht(o))),n}async function xc(e,t){const r=e.plate.version;if(!r){ue("No 'plate.version' found");return}ue("OME-NGFF plate version: "+r);const a=await qt(r,"plate");ue("Validating "+t),console.log(a),vn(a,e),await tl(e.plate,t,r)}function el(e){ue("Key: Well: <span class='valid'>valid</span> / <span class='invalid'>invalid</span>. First Image: valid: \u2713 / invalid: \u2A2F");let r=e.rows.map(n=>`<tr>${e.columns.map(o=>`<td id="${n.name}/${o.name}"></td>`).join("")}</tr>`).join("");const a=document.createElement("table");a.innerHTML=r,document.getElementById("app").appendChild(a)}async function tl(e,t,r){await qt(r,"well"),await qt(r,"image"),el(e),e.wells.forEach(async function(a){let n=a.path,o=t+n+"/.zattrs",c=await ot(o);console.log(c);let p=c.version||r;const y=await qt(p,"well");vn(y,c,!1)?document.getElementById(n).classList.add("valid"):document.getElementById(n).classList.add("invalid");let m=c.well.images[0].path,v=t+n+"/"+m+"/.zattrs",I=await ot(v);await gn(I,null,p,!1)?document.getElementById(n).innerHTML="\u2713":document.getElementById(n).innerHTML="\u2A2F"})}async function gn(e,t,r,a=!0){var m;const n=e.multiscales[0].version;n||(ue("No 'multiscales[0].version' found"),n=r||Zc),a&&ue("OME-NGFF multiscales version: "+n);const o=await qt(n);console.log(o);let c=vn(o,e,a);if(!t)return c;let p=["t","c","z","y","x"],y=e.multiscales[0].axes;y&&(p=y.map(v=>v.name?v.name:v)),ue("Axes: "+JSON.stringify(p));let h=e.multiscales[0].datasets.map(v=>v.path);ue("Paths: "+JSON.stringify(h));for(let v=0;v<h.length;v++){let I=h[v],R=t+I+"/.zarray";ue("Loading..."+R);let N=await ot(R);const _=N.shape;ue("Shape: "+JSON.stringify(_)),Ht(N,I+"/.zarray"),await Wc(t+I,p,_,(m=e.omero)==null?void 0:m.channels)}}async function rl(e){ue("Checking for labels at "+e+"labels/.zattrs");let t;try{t=await ot(e+"labels/.zattrs"),console.log("labelsAttrs",t)}catch{ue("No labels found")}if(t&&(Ht(t,"labels/.zattrs"),t.labels)){ue("Checking labels: "+JSON.stringify(t.labels));for(let r=0;r<t.labels.length;r++){let a=t.labels[r],n=e+"labels/"+a+"/";ue("Loading..."+n+".zattrs");const o=await ot(n+".zattrs");Ht(o,"labels/"+a+"/.zattrs"),await gn(o,n)}}}(async function(){let t=new URLSearchParams(window.location.search).get("source");t||alert("Use e.g. ?source=https://uk1s3.embassy.ebi.ac.uk/idr/zarr/v0.3/9836842.zarr to load OME-NGFF"),t.endsWith("/")||(t=t+"/"),ue("Loading JSON... "+t+".zattrs");const r=await ot(t+".zattrs");Ht(r,".zattrs JSON"),r.multiscales?(ue("Validating "+t),await gn(r,t),await rl(t)):r.plate?await xc(r,t):ue("No multiscales or plate found")})();
